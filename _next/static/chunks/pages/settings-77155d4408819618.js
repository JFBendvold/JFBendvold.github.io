(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[662],{38356:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/settings",function(){return a(1710)}])},1710:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return Settings}});var s=a(85893),n=a(67294),r=a(91473),o=a.n(r),i=a(92894),l=a(52259),c=a.n(l),d=a(25675),u=a.n(d),h=a(42444),g=a(36093),m=a(93040),f=a(69143),p=a(18191),x=a(52200),j=a(94312),y=a(59498);function ProfileSettings(e){let[t,a]=(0,n.useState)(0),r=t/1e3*100,[o,i]=(0,n.useState)(""),[l,d]=(0,n.useState)("FF70A6"),[w,b]=(0,n.useState)([]),[v,k]=(0,n.useState)(""),isMetamaskUser=()=>{var t;return null===(t=e.user)||void 0===t?void 0:t.metamask};async function getXp(){let t=Number(await (0,p.N1)(e.user.id));a(t)}async function newAvatar(){try{let e=await (0,g.Nk)();200===e.status&&window.location.reload()}catch(e){(0,x.H3)("Could not generate new avatar")}}async function changeStyle(e){console.log("change style to "+e),d(e),(0,f.C)(),await (0,g.Uz)(e).then(t=>{console.log(t);let a=JSON.parse(localStorage.getItem("user"));a.style=e,localStorage.setItem("user",JSON.stringify(a)),document.body.style.background="".concat(e)}).catch(e=>{console.log(e)}),(0,f.n)()}async function updateCountry(e){console.log("change country to "+e),(0,f.C)(),await (0,g.Ml)(e).then(t=>{console.log(t);let a=JSON.parse(localStorage.getItem("user"));a.country=e,localStorage.setItem("user",JSON.stringify(a)),k(e),(0,x.kl)("Country changed successfully","Your country has been changed successfully")}).catch(e=>{console.log(e)}),(0,f.n)()}return(0,n.useLayoutEffect)(()=>{e&&e.user&&(d(e.user.style),k(e.user.country),i(new Date(e.user.timestamp).toLocaleDateString()),fetch("https://valid.layercode.workers.dev/list/countries?format=select&flags=true&value=code").then(e=>e.json()).then(e=>{b(e.countries)})),getXp()},[e]),(0,s.jsxs)("div",{className:c().container,children:[(0,s.jsxs)("div",{className:c().profile,children:[(0,s.jsxs)("div",{className:c().left,children:[(0,s.jsx)(u(),{src:"".concat(y.h,"/users/image/").concat(e.user.name),alt:"Profile",width:64,height:64,className:c().profilePicture}),(0,s.jsxs)("div",{className:c().innerSection,children:[(0,s.jsxs)("h1",{children:[e.user.name,(0,s.jsx)(u(),{src:"flags/"+v+".svg",alt:"Country",width:24,height:24})]}),!isMetamaskUser()&&(0,s.jsx)("button",{className:c().editProfile,onClick:newAvatar,"data-tooltip-content":"Generate new random avatar","data-tooltip-id":"newAvatar",children:"Generate new avatar"})]})]}),(0,s.jsx)("div",{className:c().right,children:(0,s.jsx)("div",{className:c().levelBackground,style:{background:"conic-gradient(#FF70A6, #FF70A6 ".concat(r,"%, #FFD670 ").concat(r,"%, #FFD670)")},"data-tooltip-content":"".concat(t," / 1000"),"data-tooltip-id":"xp",children:(0,s.jsx)("div",{className:c().levelContainer,children:(0,s.jsx)("h1",{children:t})})})})]}),(0,s.jsxs)("div",{className:c().box,children:[(0,s.jsx)("h2",{children:"Change style"}),(0,s.jsxs)("div",{className:c().styleContainer,children:[(0,s.jsx)("div",{className:c().style,style:{background:"linear-gradient(45deg, #FF70A6 0%, #FFD670 100%)"},onClick:()=>changeStyle("linear-gradient(45deg, #FF70A6 0%, #FFD670 100%)"),"data-tooltip-content":"Default","data-tooltip-id":"default",children:"linear-gradient(45deg, #FF70A6 0%, #FFD670 100%)"===l?(0,s.jsx)("span",{className:"material-symbols-outlined",children:"done"}):null}),(0,s.jsx)("div",{className:c().style,style:{background:"linear-gradient(60deg, #333 0%, #000 100%)"},onClick:()=>changeStyle("linear-gradient(60deg, #333 0%, #000 100%)"),"data-tooltip-content":"Dark","data-tooltip-id":"dark",children:"linear-gradient(60deg, #333 0%, #000 100%)"===l?(0,s.jsx)("span",{className:"material-symbols-outlined",children:"done"}):null}),(0,s.jsx)("div",{className:c().style,style:{background:"linear-gradient(60deg, #70FFA6 0%, #70D6FF 100%)"},onClick:()=>changeStyle("linear-gradient(60deg, #70FFA6 0%, #70D6FF 100%)"),"data-tooltip-content":"Green/Blue","data-tooltip-id":"green",children:"linear-gradient(60deg, #70FFA6 0%, #70D6FF 100%)"===l?(0,s.jsx)("span",{className:"material-symbols-outlined",children:"done"}):null}),(0,s.jsx)("div",{className:c().style,style:{background:"linear-gradient(60deg, #FF70A6 0%, #70D6FF 100%)"},onClick:()=>changeStyle("linear-gradient(60deg, #FF70A6 0%, #70D6FF 100%)"),"data-tooltip-content":"Pink/Blue","data-tooltip-id":"blue",children:"linear-gradient(60deg, #FF70A6 0%, #70D6FF 100%)"===l?(0,s.jsx)("span",{className:"material-symbols-outlined",children:"done"}):null})]}),(0,s.jsxs)("div",{className:c().styleContainer,children:[(0,s.jsx)("div",{className:c().style,style:{background:"linear-gradient(60deg, rgb(0, 0, 0) 0%, rgb(24, 130, 173) 100%)"},onClick:()=>changeStyle("linear-gradient(60deg, rgb(0, 0, 0) 0%, rgb(24, 130, 173) 100%)"),"data-tooltip-content":"Ocean","data-tooltip-id":"default",children:"linear-gradient(60deg, rgb(0, 0, 0) 0%, rgb(24, 130, 173) 100%)"===l?(0,s.jsx)("span",{className:"material-symbols-outlined",children:"done"}):null}),(0,s.jsx)("div",{className:c().style,style:{background:"linear-gradient(to right top, #ff3758, #004460)"},onClick:()=>changeStyle("linear-gradient(to right top, #ff3758, #004460)"),"data-tooltip-content":"Alpha","data-tooltip-id":"dark",children:"linear-gradient(to right top, #ff3758, #004460)"===l?(0,s.jsx)("span",{className:"material-symbols-outlined",children:"done"}):null}),(0,s.jsx)("div",{className:c().style,style:{background:"linear-gradient(to left bottom, #d16ba5, #c777b9, #ba83ca, #aa8fd8, #9a9ae1, #8993e3, #758ee6, #5b88e8, #3c6fe6, #1c54e1, #0036d8, #0500cc)"},onClick:()=>changeStyle("linear-gradient(to left bottom, #d16ba5, #c777b9, #ba83ca, #aa8fd8, #9a9ae1, #8993e3, #758ee6, #5b88e8, #3c6fe6, #1c54e1, #0036d8, #0500cc)"),"data-tooltip-content":"Galaxy","data-tooltip-id":"green",children:"linear-gradient(to left bottom, #d16ba5, #c777b9, #ba83ca, #aa8fd8, #9a9ae1, #8993e3, #758ee6, #5b88e8, #3c6fe6, #1c54e1, #0036d8, #0500cc)"===l?(0,s.jsx)("span",{className:"material-symbols-outlined",children:"done"}):null}),(0,s.jsx)("div",{className:c().style,style:{background:"linear-gradient(60deg, rgb(197, 255, 158) 0%, rgb(230, 188, 86) 100%)"},onClick:()=>changeStyle("linear-gradient(60deg, rgb(197, 255, 158) 0%, rgb(230, 188, 86) 100%)"),"data-tooltip-content":"Cactus","data-tooltip-id":"blue",children:"linear-gradient(60deg, rgb(197, 255, 158) 0%, rgb(230, 188, 86) 100%)"===l?(0,s.jsx)("span",{className:"material-symbols-outlined",children:"done"}):null})]})]}),!isMetamaskUser()&&(0,s.jsxs)("div",{className:c().box,children:[(0,s.jsx)("h2",{children:"Change country"}),(0,s.jsx)(j.ZP,{options:w,onChange:e=>updateCountry(e.value),placeholder:"New country",className:c().select,classNamePrefix:"select"})]}),(0,s.jsx)("div",{className:c().box,children:(0,s.jsxs)("h3",{children:["Member since ",o]})}),(0,s.jsx)(h.u,{id:"newAvatar"}),(0,s.jsx)(h.u,{id:"xp"}),(0,s.jsx)(h.u,{id:"default"}),(0,s.jsx)(h.u,{id:"dark"}),(0,s.jsx)(h.u,{id:"green"}),(0,s.jsx)(h.u,{id:"blue"}),(0,s.jsx)(m.Z,{})]})}let w=(0,y.U)("/twoFactor");async function generateTwoFactor(){try{let e=await w.post("/add");return e}catch(e){return e.response}}async function checkTwoFactor(){try{let e=await w.get("/has2fa");return e}catch(e){return e.response}}async function disableTwoFactor(){try{let e=await w.delete("/delete");return e}catch(e){return e.response}}async function verifyTwoFactor(e,t){try{let a=await w.post("/verify",{name:e,input:t});return a}catch(e){return e.response}}var b=a(35297),v=a(54434);function SecuritySettings(e){let[t,a]=(0,n.useState)(""),[r,o]=(0,n.useState)(""),[i,l]=(0,n.useState)(""),[d,m]=(0,n.useState)(!0),[f,p]=(0,n.useState)("Passwords do not match"),[j,y]=(0,n.useState)(""),[w,k]=(0,n.useState)(!1),[N,_]=(0,n.useState)(!1),[C,F]=(0,n.useState)(!1),[S,A]=(0,n.useState)(""),[D,E]=(0,n.useState)(!0),isMetamaskUser=()=>{var t;return null===(t=e.user)||void 0===t?void 0:t.metamask};async function changePassword(){try{if(!(t&&r&&i?r!==i?((0,x.H3)("Invalid password","Passwords do not match"),!1):r.length<8?((0,x.H3)("Invalid password","Password must be at least 8 characters long"),!1):!(0>r.search(/[a-z]/i)||0>r.search(/[0-9]/))||((0,x.H3)("Invalid password","Password must contain at least one letter and one number"),!1):((0,x.H3)("Invalid password","Please fill in all fields"),!1)))return;let e=await (0,g.gQ)(t,r);console.log(e),200===e.status?((0,x.kl)("Password changed","Your password has been changed"),a(""),o(""),l("")):(0,x.H3)("Error changing password","Please try again later")}catch(e){(0,x.H3)("Error changing password","Please try again later")}}return(0,n.useLayoutEffect)(()=>{checkTwoFactor().then(e=>{if(200!==e.status&&423!==e.status){console.log("Error checking 2FA"),(0,x.H3)("Error checking 2FA","Please try again later");return}console.log(e.data),e.data?m(!0):m(!1),E(!1)})},[]),(0,n.useEffect)(()=>{console.log(e.user.name)},[]),(0,s.jsxs)("div",{className:c().container,children:[!D&&!isMetamaskUser()&&(0,s.jsxs)("div",{className:c().profile,children:[d?(0,s.jsxs)("div",{className:c().row,children:[(0,s.jsx)("p",{children:"2FA is activated"}),(0,s.jsx)(b.Z,{title:"Are you sure you want to disable 2FA?",description:"This action is not recommended",onConfirm:()=>void(F(!0),disableTwoFactor().then(e=>{if(200!==e.status){console.log("Error disabling 2FA"),(0,x.H3)("Error disabling 2FA","Please try again later"),_(!1),F(!1);return}m(!1),_(!1),F(!1),(0,x.kl)("2FA disabled","You can now login without 2FA")})),open:N,okText:"Yes",cancelText:"No",okButtonProps:{loading:C,style:{backgroundColor:"#FF70A6",color:"#FFFFFF"}},onCancel:()=>_(!1),icon:(0,s.jsx)(v.Z,{style:{color:"red"}}),children:(0,s.jsx)("button",{className:c().editProfile,onClick:()=>void _(!0),children:"Disable 2FA"})})]}):(0,s.jsxs)("div",{className:c().row,children:[(0,s.jsx)("p",{children:"2FA is not activated"}),(0,s.jsx)("button",{className:c().editProfile,onClick:()=>void(k(!0),generateTwoFactor().then(e=>{let t=e.data.qrCodeData;if(null===t){console.log("Error generating 2FA"),(0,x.H3)("Error generating 2FA","Please try again later"),k(!1);return}y(t)})),"data-tooltip-content":"2FA is a security feature that requires you to enter a code from your phone when logging in.","data-tooltip-id":"2fa",children:"Enable 2FA (Recommended)"})]}),(0,s.jsxs)("div",{className:c().popup,style:{top:w?"0":"100%"},children:[(0,s.jsx)("span",{className:"material-symbols-outlined",onClick:function(){k(!1)},children:"close"}),(0,s.jsx)("h2",{children:"Enable 2FA"}),(0,s.jsx)("h3",{children:"Scan the QR code below with your authenticator app"}),j&&(0,s.jsx)(u(),{src:j,width:200,height:200,alt:"QR code"}),(0,s.jsx)("input",{type:"text",placeholder:"Enter 2FA code",value:S,onChange:e=>A(e.target.value),className:c().input}),(0,s.jsx)("button",{className:c().button,onClick:()=>void verifyTwoFactor(e.user.name,S).then(e=>{if(200!==e.status){console.log("Error verifying 2FA"),(0,x.H3)("Error verifying 2FA","Please try again later");return}if(console.log(e.data),!e.data){console.log("Invalid 2FA code"),(0,x.H3)("Invalid 2FA code","Please try again");return}m(!0),k(!1),(0,x.kl)("2FA enabled","You can now login with 2FA")}),children:"Enable 2FA"}),(0,s.jsx)("p",{className:c().footer,children:"\xa9 2023 TokenTrivia"})]})]}),D&&(0,s.jsx)("div",{className:c().profile,children:(0,s.jsx)("p",{children:"Loading..."})}),!isMetamaskUser()&&(0,s.jsxs)("div",{className:c().box,children:[(0,s.jsx)("h2",{children:"Change Password"}),(0,s.jsx)("input",{type:"password",placeholder:"Old Password",value:t,onChange:e=>a(e.target.value),className:c().passwordInput}),(0,s.jsx)("input",{type:"password",placeholder:"New Password",value:r,onChange:e=>o(e.target.value),className:c().passwordInput}),(0,s.jsx)("input",{type:"password",placeholder:"Confirm Password",value:i,onChange:e=>l(e.target.value),className:c().passwordInput}),(0,s.jsx)("button",{onClick:()=>changePassword(!0),className:c().passwordButton,"data-tooltip-content":"Change your password","data-tooltip-id":"changePassword",children:"Change Password"})]}),isMetamaskUser()&&(0,s.jsxs)("div",{className:c().box,children:[(0,s.jsx)("h2",{children:"Metamask User"}),(0,s.jsx)("p",{children:"You are logged in with Metamask."})]}),(0,s.jsx)(h.u,{id:"2fa"}),(0,s.jsx)(h.u,{id:"changePassword"})]})}var k=a(52209),N=a(41664),_=a.n(N),C=a(74686);function WalletSettings(e){let[t,a]=(0,n.useState)(50),[r,o]=(0,n.useState)(""),[i,l]=(0,n.useState)(null),[d,u]=(0,n.useState)(!1),[j,y]=(0,n.useState)(!1),[w,b]=(0,n.useState)(!1),[v,N]=(0,n.useState)(0),[F,S]=(0,n.useState)(0),[A,D]=(0,n.useState)(""),[E,T]=(0,n.useState)([]);async function fetchTransactions(){try{let e=await (0,p.f1)();console.log(e),T(e)}catch(e){console.log(e)}}(0,n.useEffect)(()=>{e&&e.user&&a(e.user.tokens)},[e]),(0,n.useEffect)(()=>{fetchTransactions();try{window.ethereum.on("accountsChanged",e=>{0===e.length?(u(!1),o("")):(u(!0),o(e[0]))})}catch(e){console.error(e)}connectWallet()},[]);let connectWallet=async()=>{if(window&&window.ethereum){l(new k.ZPm(window.ethereum));try{let e=await window.ethereum.request({method:"eth_requestAccounts"});console.log("Address found: "+e[0]),o(e[0]),u(!0)}catch(e){console.error("No address found"),u(!1)}}};function closeDeposit(){y(!1),D("")}function closeWithdraw(){b(!1),D("")}async function deposit(){if(console.log("Depositing "+v+" tokens"),isNaN(v)){D("Please enter a valid number");return}if(v<100){D("Minimum deposit is 100 tokens");return}let t=new i.eth.Contract(C,"0x221772ff3DB4396820f9D9700F5aAE35DD3FA80f");(0,f.C)();let s=await (0,g.n5)();s=s.data;let n={from:r,to:"0x221772ff3DB4396820f9D9700F5aAE35DD3FA80f",value:i.utils.toWei((1e-4*v).toString(),"ether"),data:t.methods.deposit(s).encodeABI(),gas:3e6},o=i.eth.sendTransaction(n);o.once("transactionHash",e=>{console.log("Transaction hash:",e),(0,f.n)(),(0,x.kl)("Deposit successful","Your tokens will be added to your wallet shortly."),closeDeposit()}),o.once("receipt",t=>{console.log("Receipt:",t),(0,x.kl)("Deposit successful","Your tokens have been added to your wallet."),t.status&&a(parseInt(v)+parseInt(e.user.tokens)),D("")}),o.catch(e=>{console.log("Error:",e),(0,f.n)(),4001===e.code?(D("Transaction was rejected by the user"),(0,x.H3)("Deposit failed","Transaction was rejected by the user")):(D("Transaction failed"),(0,x.H3)("Deposit failed","Transaction failed"))})}async function withdraw(){if(console.log("Withdrawing "+F+" tokens"),isNaN(F)){D("Please enter a valid number");return}if(F<100){D("Minimum withdrawal is 100 tokens");return}if(F>t){D("You don't have enough tokens"),(0,x.H3)("Withdraw failed","You don't have enough tokens");return}(0,f.C)();let e=1e-4*F,s=await (0,g.n5)();s=s.data;let n=new i.eth.Contract(C,"0x221772ff3DB4396820f9D9700F5aAE35DD3FA80f"),o={from:r,to:"0x221772ff3DB4396820f9D9700F5aAE35DD3FA80f",data:n.methods.withdraw(s,i.utils.toWei(e.toString(),"ether")).encodeABI(),gas:3e6,value:0},l=i.eth.sendTransaction(o);l.once("transactionHash",e=>{console.log("Transaction hash:",e),(0,f.n)(),(0,x.kl)("Withdraw successful","Your tokens will be removed from your wallet shortly."),closeWithdraw()}),l.once("receipt",e=>{console.log("Receipt:",e),a(t-F),D("")}),l.catch(e=>{console.log("Error:",e),(0,f.n)(),4001===e.code?(D("Transaction was rejected by the user"),(0,x.H3)("Withdraw failed","Transaction was rejected by the user")):(D("Transaction failed"),(0,x.H3)("Withdraw failed","Transaction failed"))})}return(0,s.jsxs)("div",{className:c().container,style:{paddingTop:"20px"},children:[(0,s.jsxs)("div",{className:c().tokensHeader,children:[(0,s.jsxs)("h2",{className:c().tokens,"data-tooltip-content":"1 Token = 0.0001 ETH","data-tooltip-id":"tokens",children:[t," Tokens  (",Number(1e-4*t).toFixed(2)," ETH)"]}),(0,s.jsxs)("div",{className:c().buttons,children:[!d&&(0,s.jsx)("button",{className:c().button,onClick:connectWallet,children:"Connect Wallet"}),d&&(0,s.jsx)("button",{className:c().button,onClick:function(){if(0===E.length){(0,x.El)("Deposit disabled","You need to wait for your first transaction to be confirmed before you can deposit tokens.");return}y(!0),D("")},children:"Deposit"}),d&&(0,s.jsx)("button",{className:c().button,onClick:function(){if(0===E.length){(0,x.El)("Withdraw disabled","You need to wait for your first transaction to be confirmed before you can withdraw tokens.");return}b(!0),D("")},children:"Withdraw"})]})]}),(0,s.jsx)("div",{className:c().box,children:(0,s.jsxs)("div",{className:c().transactions,children:[(0,s.jsx)("h2",{children:"Transactions:"}),(0,s.jsxs)("div",{className:c().table,children:[(0,s.jsxs)("div",{className:c().tableRow,children:[(0,s.jsx)("div",{className:c().tableHeader,children:(0,s.jsx)("p",{children:"Transaction"})}),(0,s.jsx)("div",{className:c().tableHeader,children:(0,s.jsx)("p",{children:"Amount"})}),(0,s.jsx)("div",{className:c().tableHeader,children:(0,s.jsx)("p",{children:"Date"})})]}),null==E?void 0:E.map((e,t)=>{var a;let n=e[0],r=1e-14*Number(e[1]),o=(a=Number(e[2]),new Date(1e3*a).toLocaleString());return"addBalance"===n?n="Bonus":"deposit"===n?n="Deposit":"withdraw"===n?(n="Withdraw",r*=-1):"game"===n&&(n="Game Buy-in",r*=-1),(0,s.jsxs)("div",{className:c().tableRow,children:[(0,s.jsx)("div",{className:c().tableData,children:(0,s.jsx)("p",{children:n})}),(0,s.jsx)("div",{className:c().tableData,children:(0,s.jsxs)("p",{children:[r," Tokens"]})}),(0,s.jsx)("div",{className:c().tableData,children:(0,s.jsx)("p",{children:o})})]},t)})]})]})}),(0,s.jsx)("div",{className:c().box,children:(0,s.jsx)(_(),{href:"https://sepolia.etherscan.io/address/0x221772ff3DB4396820f9D9700F5aAE35DD3FA80f",passHref:!0,children:(0,s.jsx)("p",{className:c().link,children:"View on Etherscan"})})}),(0,s.jsxs)("div",{className:c().popup,style:{top:j?"0":"100%"},children:[(0,s.jsx)("span",{className:"material-symbols-outlined",onClick:closeDeposit,children:"close"}),(0,s.jsx)("h2",{children:"Deposit"}),(0,s.jsx)("h3",{children:"1 Token = 0.0001 ETH"})," ",(0,s.jsx)("p",{children:"How many tokens would you like to deposit?"}),(0,s.jsx)("input",{type:"text",placeholder:"Tokens",className:c().input,value:v,onChange:e=>N(e.target.value)}),(0,s.jsxs)("p",{className:c().eth,children:["You will deposit ",1e-4*v," ETH"]}),(0,s.jsx)("button",{className:c().button,onClick:deposit,children:"Deposit"}),(0,s.jsx)("p",{className:c().error,children:A}),(0,s.jsx)("p",{className:c().footer,children:"\xa9 2023 TokenTrivia"})]}),(0,s.jsxs)("div",{className:c().popup,style:{top:w?"0":"100%"},children:[(0,s.jsx)("span",{className:"material-symbols-outlined",onClick:closeWithdraw,children:"close"}),(0,s.jsx)("h2",{children:"Withdraw"}),(0,s.jsx)("h3",{children:"1 Token = 0.0001 ETH"}),(0,s.jsx)("p",{children:"How many tokens would you like to withdraw?"}),(0,s.jsx)("input",{type:"text",placeholder:"Tokens",className:c().input,value:F,onChange:e=>S(e.target.value),"data-tooltip-content":"Minimum withdrawal is 100 tokens","data-tooltip-id":"withdraw"}),(0,s.jsxs)("p",{className:c().eth,children:["You will withdraw ",1e-4*F," ETH"]}),(0,s.jsx)("button",{className:c().button,onClick:withdraw,children:"Withdraw"}),(0,s.jsx)("p",{className:c().error,children:A}),(0,s.jsx)("p",{className:c().footer,children:"\xa9 2023 TokenTrivia"}),(0,s.jsx)(h.u,{id:"withdraw"})]}),(0,s.jsx)(h.u,{id:"tokens"}),(0,s.jsx)(m.Z,{})]})}var F=a(79984);function AdminSettings(e){let[t,a]=(0,n.useState)(!1);(0,n.useEffect)(()=>{(0,F.C)().then(e=>{console.log(e.data),"admin"===e.data?(console.log("User is admin"),a(!0)):(console.log("User is not admin"),a(!1))}).catch(e=>{console.log(e)})},[]);let isMetamaskUser=()=>{var t;return null===(t=e.user)||void 0===t?void 0:t.metamask};return(0,s.jsxs)("div",{className:c().container,children:[!isMetamaskUser()&&t&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:c().profile,children:(0,s.jsxs)("h2",{children:["Welcome back ",e.user.name,"!",(0,s.jsx)("br",{}),"With great power comes great responsibility."]})}),(0,s.jsxs)("div",{className:c().box,children:[(0,s.jsx)("h2",{children:"Admin Panel"}),(0,s.jsxs)("div",{className:c().adminLinks,children:[(0,s.jsx)(_(),{href:"/admin/feedbacks",children:(0,s.jsx)("p",{className:c().adminLink,children:"Feedbacks"})}),(0,s.jsx)(_(),{href:"/admin/users",children:(0,s.jsx)("p",{className:c().adminLink,children:"Users"})}),(0,s.jsx)(_(),{href:"/admin/questions",children:(0,s.jsx)("p",{className:c().adminLink,children:"Questions"})}),(0,s.jsx)(_(),{href:"/admin/admins",children:(0,s.jsx)("p",{className:c().adminLink,children:"Admins"})})]})]}),(0,s.jsx)(m.Z,{})]}),isMetamaskUser()&&(0,s.jsxs)("div",{className:c().box,children:[(0,s.jsx)("h2",{children:"Metamask User"}),(0,s.jsx)("p",{children:"You are logged in with Metamask."})]}),!t&&(0,s.jsxs)("div",{className:c().box,children:[(0,s.jsx)("h2",{children:"Not an admin"}),(0,s.jsx)("p",{children:"You are not an admin."})]})]})}let S=(0,y.U)("/rewards");async function getReferralCode(){try{let e=await S.get("/get");return e}catch(e){return e.response}}async function generateReferralCode(){try{let e=await S.post("/add");return e}catch(e){return e.response}}let A=(0,y.U)("/affiliation");async function addAffiliation(e){try{let t=await A.post("/add",{code:e});return t}catch(e){return e.response}}function RewardsSettings(e){let[t,a]=(0,n.useState)("..."),[r,o]=(0,n.useState)("");(0,n.useEffect)(()=>{getReferralCode().then(e=>{200==e.status?a(e.data):404==e.status?a(null):(a(null),(0,x.H3)("Error","Failed to get referral code."))})},[]);let isMetamaskUser=()=>{var t;return null===(t=e.user)||void 0===t?void 0:t.metamask};return(0,s.jsxs)("div",{className:c().container,children:[!isMetamaskUser()&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:c().profile,children:(0,s.jsx)("h2",{children:"Affiliate Program"})}),(0,s.jsxs)("div",{className:c().box,children:[(0,s.jsxs)("div",{className:c().rewardBox,children:[(0,s.jsx)("h2",{"data-tooltip-content":"Share your referral code with your friends and earn 2% of their earnings.","data-tooltip-id":"tooltip",children:"Referral Code"}),(0,s.jsx)("div",{className:c().rewardBoxContent,onClick:()=>{if(t){let e=document.createElement("textarea");e.value=t,document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e),(0,x.kl)("Referral code copied to clipboard.")}else generateReferralCode().then(e=>{console.log(e),200==e.status?(a(e.data.code),(0,x.kl)("Success","Referral code generated.")):(0,x.H3)("Error","Failed to generate referral code.")})},children:(0,s.jsx)("p",{children:t||"Get Referral Code"})})]}),(0,s.jsxs)("div",{className:c().rewardBox,children:[(0,s.jsx)("h2",{"data-tooltip-content":"Enter your friend's referral code","data-tooltip-id":"tooltip",children:"Enter Referral Code"}),(0,s.jsx)("input",{type:"text",placeholder:"Enter Referral Code",value:r,onChange:e=>o(e.target.value)}),(0,s.jsx)("button",{onClick:()=>{if(6!=r.length){(0,x.H3)("Error","Referral code is invalid.");return}addAffiliation(r).then(e=>{200==e.status?(0,x.kl)("Success","Affiliation added."):404==e.status?(0,x.H3)("Error","Referral code is invalid."):406==e.status?(0,x.H3)("Error","You can't add your own referral code."):409==e.status?(0,x.El)("You already have this affiliation."):(0,x.H3)("Error","Failed to add affiliation.")})},children:"Submit"})]})]}),(0,s.jsx)(m.Z,{})]}),isMetamaskUser()&&(0,s.jsxs)("div",{className:c().box,children:[(0,s.jsx)("h2",{children:"Metamask User"}),(0,s.jsx)("p",{children:"You are logged in with Metamask."})]}),(0,s.jsx)(h.u,{id:"tooltip"})]})}var D=a(11163);function Settings(){let e=(0,n.useRef)(null),t=(0,n.useRef)(null),[a,r]=(0,n.useState)(0),[l,c]=(0,n.useState)({}),[d,u]=(0,n.useState)("#FF70A6"),[h,g]=(0,n.useState)(!1),[m,f]=(0,n.useState)(!1),p=(0,D.useRouter)(),isMetamaskUser=()=>null==l?void 0:l.metamask;return(0,n.useLayoutEffect)(()=>{(0,F.C)().then(e=>{"admin"===e.data?g(!0):g(!1)}).catch(e=>{console.log(e)}),t.current.style.opacity=1;let e=localStorage.getItem("user");e?c(JSON.parse(e)):(console.error("No user found in local storage"),p.push("/login"));let a=new URLSearchParams(window.location.search),s=a.get("page");if(s)try{let e=parseInt(s);isMetamaskUser()&&(1===e||e>4)?r(0):r(e)}catch(e){console.log(e)}},[]),(0,n.useEffect)(()=>(l&&l.style&&(u(l.style),document.body.style.background="".concat(l.style)),()=>{document.body.style.background="".concat(d)}),[l]),(0,s.jsxs)("main",{className:o().main,ref:e,children:[(0,s.jsx)(i.Z,{}),(0,s.jsxs)("div",{className:o().content,ref:t,children:[(0,s.jsx)("div",{className:o().leftMenuButton,onClick:()=>f(!m),style:{left:m?"200px":0},children:(0,s.jsx)("span",{className:"material-symbols-outlined",children:m?"chevron_left":"chevron_right"})}),(0,s.jsxs)("div",{className:o().leftMenu,style:{left:m?0:"-200px"},children:[(0,s.jsx)("div",{className:o().leftMenuHeader,children:(0,s.jsx)("h1",{children:"Settings"})}),(0,s.jsx)("div",{className:o().leftMenuContent,children:(0,s.jsxs)("ul",{children:[(0,s.jsx)("li",{children:(0,s.jsxs)("button",{className:0===a?o().active:"",onClick:()=>r(0),children:[(0,s.jsx)("span",{className:"material-symbols-outlined",children:"person"}),"Profile"]})}),!isMetamaskUser()&&(0,s.jsx)("li",{children:(0,s.jsxs)("button",{className:1===a?o().active:"",onClick:()=>r(1),children:[(0,s.jsx)("span",{className:"material-symbols-outlined",children:"lock"}),"Security"]})}),(0,s.jsx)("li",{children:(0,s.jsxs)("button",{className:2===a?o().active:"",onClick:()=>r(2),children:[(0,s.jsx)("span",{className:"material-symbols-outlined",children:"payment"}),"Wallet"]})}),(0,s.jsx)("li",{children:(0,s.jsxs)("button",{className:3===a?o().active:"",onClick:()=>r(3),children:[(0,s.jsx)("span",{className:"material-symbols-outlined",children:"card_giftcard"}),"Rewards"]})}),(0,s.jsx)("li",{children:(0,s.jsxs)("button",{className:4===a?o().active:"",onClick:()=>r(4),children:[(0,s.jsx)("span",{className:"material-symbols-outlined",children:"history"}),"History"]})}),h&&!isMetamaskUser()&&(0,s.jsx)("li",{children:(0,s.jsxs)("button",{className:5===a?o().active:"",onClick:()=>r(5),children:[(0,s.jsx)("span",{className:"material-symbols-outlined",children:"admin_panel_settings"}),"Admin"]})})]})})]}),(0,s.jsxs)("div",{className:o().rightMenu,children:[0===a&&(0,s.jsx)(ProfileSettings,{user:l}),1===a&&(0,s.jsx)(SecuritySettings,{user:l}),2===a&&(0,s.jsx)(WalletSettings,{user:l}),3===a&&(0,s.jsx)(RewardsSettings,{user:l}),4===a&&(0,s.jsx)("h1",{children:"History"}),5===a&&(0,s.jsx)(AdminSettings,{user:l})]})]})]})}},79984:function(e,t,a){"use strict";a.d(t,{C:function(){return getAuthority},k:function(){return addAdmin}});var s=a(59498);let n=(0,s.U)("/authority"),getAuthority=async()=>{try{let e=await n.get("/get");return e}catch(e){return e.response}},addAdmin=async e=>{try{let t=await n.put("/setAdmin",{username:e});return t}catch(e){return e.response}}},91473:function(e){e.exports={main:"settings_main__kPqXf",content:"settings_content__xpd_4",leftMenu:"settings_leftMenu__krhiY",rightMenu:"settings_rightMenu__lguZZ",leftMenuContent:"settings_leftMenuContent__6SuQt",active:"settings_active__wroGF",leftMenuButton:"settings_leftMenuButton__HApW_"}},52259:function(e){e.exports={container:"settingsContent_container__iKuiQ",profile:"settingsContent_profile__DgXX3",left:"settingsContent_left__xRVlt",innerSection:"settingsContent_innerSection__dz_Qs",right:"settingsContent_right__gKCUr",levelBackground:"settingsContent_levelBackground__GL9EK",levelContainer:"settingsContent_levelContainer__oMynP",row:"settingsContent_row__WyghR",box:"settingsContent_box__rCKr_",passwordInput:"settingsContent_passwordInput__TeZfd",passwordButton:"settingsContent_passwordButton__KyAlf",tokensHeader:"settingsContent_tokensHeader__LWyhr",buttons:"settingsContent_buttons__7wYHe",styleContainer:"settingsContent_styleContainer__xoUX2",style:"settingsContent_style__dUJMZ",popup:"settingsContent_popup__qKfKA",eth:"settingsContent_eth__LgH7D",footer:"settingsContent_footer__bkJ8S",transactions:"settingsContent_transactions__oekr5",table:"settingsContent_table__VO_5X",tableRow:"settingsContent_tableRow___sRES",tableHeader:"settingsContent_tableHeader__Z0jBs",tableData:"settingsContent_tableData__Z_Wkh",adminLinks:"settingsContent_adminLinks__YYWEh",rewardBox:"settingsContent_rewardBox__zuyoy",rewardBoxContent:"settingsContent_rewardBoxContent__yhCdp",profilePicture:"settingsContent_profilePicture__LgY75"}}},function(e){e.O(0,[664,209,675,318,227,853,297,312,54,260,774,888,179],function(){return e(e.s=38356)}),_N_E=e.O()}]);