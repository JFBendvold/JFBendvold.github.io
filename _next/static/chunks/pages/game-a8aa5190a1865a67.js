(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[203,260],{23874:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/game",function(){return n(97893)}])},93040:function(e,t,n){"use strict";n.d(t,{Z:function(){return LoadingScreen}});var s=n(85893),a=n(99205),i=n.n(a);function LoadingScreen(){return(0,s.jsx)("div",{className:i().loaderContainer,id:"loading-screen",style:{display:"none"},children:(0,s.jsx)("div",{className:i().loader})})}},92894:function(e,t,n){"use strict";n.d(t,{Z:function(){return Header}});var s=n(85893),a=n(9057),i=n.n(a),r=n(41664),o=n.n(r),l=n(25675),c=n.n(l),u=n(67294),d=n(11163),m=n(18191),h=n(59498);function Header(){let[e,t]=(0,u.useState)(0),[n,a]=(0,u.useState)({}),r=(0,d.useRouter)();async function getTokensFromBlockchain(){let e=await (0,m.lz)();if(-1===e){console.error("Error getting tokens from blockchain");return}t(e),n.tokens=e,a(n),localStorage.setItem("user",JSON.stringify(n))}return(0,u.useEffect)(()=>{(async function(){let e=localStorage.getItem("user");e?(a(JSON.parse(e)),t(JSON.parse(e).tokens)):(console.error("No user found in local storage"),r.push("/login"))})()},[]),(0,u.useEffect)(()=>{n.name&&""!==n.name&&getTokensFromBlockchain()},[n.name]),(0,s.jsx)("header",{className:i().header,children:(0,s.jsxs)("div",{className:i().inner,children:[(0,s.jsxs)(o(),{className:i().logo,href:"/dashboard",children:[(0,s.jsx)("h1",{children:"T"}),(0,s.jsx)("h1",{children:"O"}),(0,s.jsx)("h1",{children:"K"}),(0,s.jsx)("h1",{children:"E"}),(0,s.jsx)("h1",{children:"N"}),(0,s.jsx)("h1",{children:"T"}),(0,s.jsx)("h1",{children:"R"}),(0,s.jsx)("h1",{children:"I"}),(0,s.jsx)("h1",{children:"V"}),(0,s.jsx)("h1",{children:"I"}),(0,s.jsx)("h1",{children:"A"})]}),(0,s.jsxs)("div",{className:i().content,children:[(0,s.jsxs)(o(),{className:i().wallet,href:"/settings?page=2",children:[(0,s.jsx)("span",{children:e}),(0,s.jsx)("p",{children:"Tokens"})]}),(0,s.jsxs)("div",{href:"/profile",className:i().profile,children:[(0,s.jsx)(c(),{src:"".concat(h.h,"/users/image/").concat(n.name),alt:"Profile",width:36,height:36}),(0,s.jsxs)("div",{className:i().dropdown,children:[(0,s.jsx)(o(),{href:"/settings?page=0",children:(0,s.jsx)("span",{className:"material-symbols-outlined",children:"person"})}),(0,s.jsx)(o(),{href:"/settings?page=1",children:(0,s.jsx)("span",{className:"material-symbols-outlined",children:"settings"})}),(0,s.jsx)(o(),{href:"/settings?page=2",children:(0,s.jsx)("span",{className:"material-symbols-outlined",children:"sync_alt"})}),(0,s.jsx)(o(),{href:"/logout",children:(0,s.jsx)("span",{className:"material-symbols-outlined",children:"logout"})})]})]})]})]})})}},97893:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return Game}});var s=n(85893),a=n(67294),i=n(72537),r=n.n(i),o=n(14799),l=n.n(o),c=n(92894),u=n(42444),d=n(40725),m=n.n(d),h=n(52200),p=n(18191),y=n(36093);function Search(e){let t=(0,a.useRef)(null),[n,i]=(0,a.useState)("#FF70A6"),r=[50,100,250,500,1e3,2500,5e3,1e4],[o,d]=(0,a.useState)(0),[b,g]=(0,a.useState)(r[0]),[_,f]=(0,a.useState)(!1),[x,j]=(0,a.useState)(!1),[v,N]=(0,a.useState)("Searching for a lobby..."),[w,S]=(0,a.useState)(null),[C,T]=(0,a.useState)(0),[k,E]=(0,a.useState)(0),[D,G]=(0,a.useState)(!1),[I,A]=(0,a.useState)(!1),[F,M]=(0,a.useState)(!1),P=(0,a.useRef)(null),[O,U]=(0,a.useState)([]),[B,R]=(0,a.useState)([]);async function search(){if(o<b){(0,h.El)("Insufficient funds","You don't have enough tokens to join this lobby.");return}j(!0),console.log("Searching for a lobby...");let t=await (0,y.n5)();e.websocket.emit("join",{price:b,username:w.name,userId:t.data})}async function checkUser(){let t=await (0,y.n5)();e.websocket.emit("checkUser",{username:w.name,userId:t.data})}function Cell(e){let{x:t,y:n,revealCell:a}=e,i=B[t][n],{isMine:r,revealed:o,flagged:c,adjacentMines:u}=i;return(0,s.jsxs)("div",{onClick:()=>{I||F||a(r,0===u,t,n)},onContextMenu:e=>{e.preventDefault(),I||F||function(e,t){let n=[...B];n[e][t].flagged=!n[e][t].flagged,R(n)}(t,n)},className:o?l().cellRevealed:l().cell,children:[o&&(r?"\uD83D\uDCA3":u),!o&&c&&"\uD83D\uDEA9"]})}function revealCell(e,t,n,s){let a=[...B];a[n][s].revealed=!0,e?(A(!0),console.log("Game over!"),function(e){for(let t=0;t<10;t++)for(let n=0;n<10;n++)e[t][n].isMine&&(e[t][n].revealed=!0)}(a)):t&&function revealAdjacentCells(e,t,n){for(let[s,a]of[[-1,-1],[-1,0],[-1,1],[0,-1],[0,1],[1,-1],[1,0],[1,1]]){let i=t+s,r=n+a;i>=0&&i<10&&r>=0&&r<10&&!e[i][r].revealed&&(e[i][r].revealed=!0,0===e[i][r].adjacentMines&&revealAdjacentCells(e,i,r))}}(a,n,s);let i=0;for(let e=0;e<10;e++)for(let t=0;t<10;t++)!a[e][t].revealed&&i++;15===i&&(M(!0),console.log("Game won!")),R(a)}function fillEmptyGrid(){let e=[];for(let t=0;t<10;t++)e.push(Array(10).fill().map(()=>({isMine:!1,revealed:!1,flagged:!1,adjacentMines:0})));U(e)}return(0,a.useEffect)(()=>{S(JSON.parse(localStorage.getItem("user"))),i(JSON.parse(localStorage.getItem("user")).style),T(window.innerWidth),E(window.innerHeight),t.current.style.background="".concat(n)},[]),(0,a.useEffect)(()=>{w&&(checkUser(),i(JSON.parse(localStorage.getItem("user")).style),t.current.style.background="".concat(n))},[w]),(0,a.useEffect)(()=>{w&&(0,p.lz)().then(e=>{if(-1===e){console.error("Error getting tokens from blockchain");return}d(e),w.tokens=e,S(w),localStorage.setItem("user",JSON.stringify(w))})},[w]),(0,a.useEffect)(()=>{e.websocket&&e.websocket.on("searchingUpdated",e=>{"Creating new Lobby!"==e&&(console.log(e),N(e)),"Adding user to the Lobby!"==e&&(console.log(e),N(e))})}),(0,a.useEffect)(()=>{fillEmptyGrid()},[]),(0,a.useEffect)(()=>{if(0===O.length)return;let e=[...O],t=0;for(;t<15;){let n=Math.floor(10*Math.random()),s=Math.floor(10*Math.random());if(!e[n][s].isMine){e[n][s].isMine=!0,t++;for(let t=-1;t<2;t++)for(let a=-1;a<2;a++)n+t>=0&&n+t<10&&s+a>=0&&s+a<10&&e[n+t][s+a].adjacentMines++}}R(e)},[O]),(0,s.jsxs)("main",{className:l().main,ref:t,children:[!x&&(0,s.jsx)(c.Z,{}),(0,s.jsxs)("div",{className:l().content,style:{transform:x?"translateY(-100vh) scale(0.5)":"translateY(0vh) scale(1)",opacity:x?0:1},children:[(0,s.jsxs)("div",{className:l().searchFilter,children:[(0,s.jsxs)("h1",{className:l().pottitle,"data-tooltip-content":"The pot is the amount of tokens you can win.","data-tooltip-id":"pot",children:[(0,s.jsx)("span",{className:"material-symbols-outlined",children:"trophy"}),8*b," ",(0,s.jsx)("span",{className:l().currency,children:"Tokens"})]}),(0,s.jsxs)("h1",{className:l().feetitle,"data-tooltip-content":"The fee is the amount of tokens you pay to enter a lobby.","data-tooltip-id":"buyInFee",children:[(0,s.jsx)("span",{className:"material-symbols-outlined",children:"payments"}),b," ",(0,s.jsx)("span",{className:l().currency,children:"Tokens"})]}),(0,s.jsxs)("div",{className:l().timeEstimateContainer,"data-tooltip-content":"The time estimate is based on the average time it takes to find a lobby.","data-tooltip-id":"searchTime",children:[(0,s.jsx)("span",{className:"material-symbols-outlined",children:"hourglass_empty"}),(0,s.jsx)("p",{className:l().timeEstimate,children:"1-5 minutes"})]}),(0,s.jsx)("div",{className:l().searchOptionsContainer,style:{height:_?"100px":"0px"},children:r.map((e,t)=>(0,s.jsxs)("div",{className:l().searchOption,onClick:()=>{if(o<e){(0,h.El)("Insufficient funds","You don't have enough tokens to join this lobby.");return}g(e)},style:{backgroundColor:b==e?"#FF70A6":"#FFFFFF",color:b==e?"#FFFFFF":"#000000"},children:[e," ",(0,s.jsx)("span",{className:l().currency,children:"Tokens"})]},t))}),(0,s.jsx)("div",{className:l().expandButtonContainer,children:(0,s.jsx)("span",{className:"material-symbols-outlined",onClick:()=>f(!_),children:_?"expand_less":"expand_more"})})]}),(0,s.jsx)("div",{className:l().buttonContainer,children:(0,s.jsx)("button",{className:l().button,onClick:search,children:"Join a lobby"})}),(0,s.jsx)(u.u,{id:"searchTime"}),(0,s.jsx)(u.u,{id:"buyInFee"}),(0,s.jsx)(u.u,{id:"pot"})]}),(0,s.jsx)("div",{className:l().searchingContainer,style:{transform:x&&!D?"translateY(0vh) scale(1)":"translateY(100vh) scale(0.5)",opacity:x&&!D?1:0},children:(0,s.jsxs)("div",{className:l().searching,children:[(0,s.jsx)("div",{className:l().spinner,"data-tooltip-content":"Click to start the minigame!","data-tooltip-id":"gameStart",onClick:()=>G(!0)}),(0,s.jsx)("div",{className:l().searchingText,children:(0,s.jsx)("h1",{className:l().searchingTitle,children:v})})]})}),(0,s.jsxs)("div",{className:l().miniGameContainer,style:{transform:D?"translateY(0vh) scale(1)":"translateY(100vh) scale(0.5)",opacity:D?1:0},children:[(0,s.jsx)("div",{className:l().searchingStatus,children:(0,s.jsx)("h1",{className:l().searchingTitle,children:v})}),(0,s.jsx)("div",{className:l().miniGame,children:(0,s.jsx)("div",{className:l().grid,ref:P,children:B.map((e,t)=>e.map((e,n)=>(0,s.jsx)(Cell,{x:t,y:n,revealCell:revealCell},"".concat(t,"-").concat(n))))})}),(0,s.jsx)("div",{className:l().restartButtonContainer,children:(0,s.jsx)("button",{className:l().restartButton,onClick:function(){A(!1),M(!1),fillEmptyGrid()},children:"Restart"})})]}),(0,s.jsxs)("div",{className:l().bubbleContainer,children:[(0,s.jsx)("div",{className:l().bubble}),(0,s.jsx)("div",{className:l().bubble}),(0,s.jsx)("div",{className:l().bubble}),(0,s.jsx)("div",{className:l().bubble}),(0,s.jsx)("div",{className:l().bubble}),(0,s.jsx)("div",{className:l().bubble}),(0,s.jsx)("div",{className:l().bubble}),(0,s.jsx)("div",{className:l().bubble}),(0,s.jsx)("div",{className:l().bubble}),(0,s.jsx)("div",{className:l().bubble}),(0,s.jsx)("div",{className:l().bubble}),(0,s.jsx)("div",{className:l().bubble}),(0,s.jsx)("div",{className:l().bubble}),(0,s.jsx)("div",{className:l().bubble})]}),(0,s.jsx)(u.u,{id:"gameStart"}),(0,s.jsx)(m(),{width:C,height:k,numberOfPieces:100,recycle:!1,run:F})]})}var b=n(69143),g=n(93040),_=n(53920),f=n(56486),x=n.n(f),j=n(25675),v=n.n(j),N=n(59498);function Lobby(e){let[t,n]=(0,a.useState)(null),[i,r]=(0,a.useState)(null),[o,l]=(0,a.useState)([]),[c,u]=(0,a.useState)(null),[d,m]=(0,a.useState)(null),[h,p]=(0,a.useState)({}),[b,g]=(0,a.useState)(null),[_,f]=(0,a.useState)(!1),[j,w]=(0,a.useState)(!1);function sendEmote(e){console.log("Sending emote",e),i.emit("emoji",{emoji:e,id:t.id,username:c.name}),m(e),setTimeout(()=>{m(null)},3e3)}return(0,a.useEffect)(()=>{n(e.lobby),r(e.websocket),u(JSON.parse(localStorage.getItem("user")))},[]),(0,a.useEffect)(()=>{t&&(0,y.Gt)(t.users).then(e=>{console.log("Got lobby users",e),l(e)})},[t]),(0,a.useEffect)(()=>{i&&(i.on("emoji",e=>{console.log("Got emoji",e),p(t=>({...t,[e.username]:e.emoji})),setTimeout(()=>{p(t=>({...t,[e.username]:null}))},3e3)}),i.on("timer",e=>{console.log("Got timer",e),g(e),f(!0)}))},[i]),(0,a.useEffect)(()=>{i&&i.on("lobby",e=>{console.log("Updated lobby",e),n(e)})},[i]),(0,s.jsxs)("div",{className:x().lobby,children:[(0,s.jsxs)("div",{className:x().top,children:[!_&&(0,s.jsxs)("h1",{children:["Waiting for players",(0,s.jsx)("span",{className:x().dot,children:"."}),(0,s.jsx)("span",{className:x().dot,children:"."}),(0,s.jsx)("span",{className:x().dot,children:"."})]}),b>0&&(0,s.jsxs)("h2",{children:["Game starts in ",b]}),0==b&&(0,s.jsx)("h2",{children:"The game is starting!"})]}),(0,s.jsx)("div",{className:x().mid,children:o.map((e,t)=>(0,s.jsxs)("div",{className:x().user,children:[h[e.name]&&(0,s.jsx)("div",{className:x().activeEmote,children:(0,s.jsx)("span",{children:h[e.name]})}),(0,s.jsx)(v(),{src:"".concat(N.h,"/users/image/").concat(e.name),width:128,height:128,alt:"User image"}),(0,s.jsxs)("h2",{children:[e.name,(0,s.jsx)(v(),{className:x().flag,src:"/flags/".concat(e.country,".svg"),width:32,height:32,alt:"User country"})]})]},t))}),(0,s.jsxs)("div",{className:x().bottom,children:[(0,s.jsxs)("div",{className:x().emotes,children:[(0,s.jsx)("div",{className:x().emote,onClick:()=>sendEmote("\uD83D\uDE01"),children:(0,s.jsx)("span",{children:"\uD83D\uDE01"})}),(0,s.jsx)("div",{className:x().emote,onClick:()=>sendEmote("\uD83D\uDE02"),children:(0,s.jsx)("span",{children:"\uD83D\uDE02"})}),(0,s.jsx)("div",{className:x().emote,onClick:()=>sendEmote("\uD83D\uDCA9"),children:(0,s.jsx)("span",{children:"\uD83D\uDCA9"})}),(0,s.jsx)("div",{className:x().emote,onClick:()=>sendEmote("\uD83E\uDD21"),children:(0,s.jsx)("span",{children:"\uD83E\uDD21"})}),(0,s.jsx)("div",{className:x().emote,onClick:()=>sendEmote("\uD83D\uDC80"),children:(0,s.jsx)("span",{children:"\uD83D\uDC80"})}),(0,s.jsx)("div",{className:x().emote,onClick:()=>sendEmote("\uD83D\uDD25"),children:(0,s.jsx)("span",{children:"\uD83D\uDD25"})})]}),(0,s.jsx)("div",{className:x().mute,onClick:()=>w(!j),children:j?(0,s.jsx)("span",{className:"material-symbols-outlined",children:"volume_off"}):(0,s.jsx)("span",{className:"material-symbols-outlined",children:"volume_up"})})]}),d&&(0,s.jsx)("div",{className:x().sentEmote,children:(0,s.jsx)("span",{children:d})}),(0,s.jsx)("audio",{autoPlay:!0,loop:!0,muted:j,children:(0,s.jsx)("source",{src:"/sfx/lobbySong.mp3",type:"audio/mpeg"})})]})}var w=n(98466),S=n.n(w),C=n(11163);n(72076);var T=n(41064),k=n.n(T);function Bubbles(e){let{content:t}=e;return(0,s.jsxs)("div",{className:k().bubbleContainer,children:[(0,s.jsx)("div",{className:k().bubble,children:t}),(0,s.jsx)("div",{className:k().bubble,children:t}),(0,s.jsx)("div",{className:k().bubble,children:t}),(0,s.jsx)("div",{className:k().bubble,children:t}),(0,s.jsx)("div",{className:k().bubble,children:t}),(0,s.jsx)("div",{className:k().bubble,children:t}),(0,s.jsx)("div",{className:k().bubble,children:t}),(0,s.jsx)("div",{className:k().bubble,children:t}),(0,s.jsx)("div",{className:k().bubble,children:t}),(0,s.jsx)("div",{className:k().bubble,children:t}),(0,s.jsx)("div",{className:k().bubble,children:t}),(0,s.jsx)("div",{className:k().bubble,children:t}),(0,s.jsx)("div",{className:k().bubble,children:t}),(0,s.jsx)("div",{className:k().bubble,children:t})]})}function InGame(e){let[t,n]=(0,a.useState)(0),[i,r]=(0,a.useState)(null),[o,l]=(0,a.useState)(!1),[c,u]=(0,a.useState)(400),[d,h]=(0,a.useState)(null),[p,b]=(0,a.useState)(null),[g,_]=(0,a.useState)([]),[f,x]=(0,a.useState)(null),[j,v]=(0,a.useState)(null),[N,w]=(0,a.useState)("Random"),[T,k]=(0,a.useState)(0),[E,D]=(0,a.useState)(0),G=(0,C.useRouter)(),[I,A]=(0,a.useState)(""),[F,M]=(0,a.useState)([]),[P,O]=(0,a.useState)(0),[U,B]=(0,a.useState)(!0),[R,Z]=(0,a.useState)(!1),[L,q]=(0,a.useState)(""),[H,Y]=(0,a.useState)(-1),[J,Q]=(0,a.useState)(15),[W,X]=(0,a.useState)(100),[V,z]=(0,a.useState)(-1),[K,$]=(0,a.useState)(!1),[ee,et]=(0,a.useState)(0),en=0,es=!1;async function fetchUserId(){let e=await (0,y.n5)();v(e)}function goToDashboard(){G.push("/dashboard")}return(0,a.useEffect)(()=>{h(e.lobby),b(e.websocket),r(e.game),$(!1),es=!1,e.game&&(w(e.game.category.name),u(e.game.pot)),k(window.innerWidth),D(window.innerHeight),x(JSON.parse(localStorage.getItem("user"))),fetchUserId(),setTimeout(()=>{l(!0)},15e3)},[]),(0,a.useEffect)(()=>{d&&(0,y.Gt)(d.users).then(e=>{console.log("Got lobby users",e),_(e)})},[d]),(0,a.useEffect)(()=>{p&&(p.on("question",e=>{K||es||(console.log("New question",e),A(e.text),M(e.answers),q(e.fact),Y(-1),B(!0),O(e.number+1),en++,n(2))}),p.on("timer",e=>{Q(e),X(e/10*100)}),p.on("answerResponse",e=>{console.log("Answer response",e),Z(e)}),p.on("closeQuestion",()=>{K||es||(console.log("Closing question"),B(!1),setTimeout(()=>{n(1)},5e3))}),p.on("wrongAnswer",()=>{console.log("Wrong answer"),$(!0),es=!0,n(4)}),p.on("kickedUsers",e=>{console.log("Kicked users",e),e.includes(f.name)&&(console.log("You were kicked"),$(!0),es=!0,n(4))}),p.on("numPlayers",e=>{console.log("Players left:",e),et(e.length)}),p.on("endGame",e=>{K||es||(console.log("End game",e),u(e.pot),n(3))}))},[p]),(0,s.jsxs)("div",{className:S().container,children:[0===t&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:S().intro,children:[(0,s.jsx)("h1",{children:"Welcome to Trivia, with a twist of crypto!"}),(0,s.jsxs)("p",{children:["Answer 10 questions correctly to win the pot of ",c," Tokens!"]})]}),(0,s.jsxs)("div",{className:S().categories,children:[(0,s.jsx)("h2",{children:"Let's find out what category you'll be playing in!"}),(0,s.jsxs)("div",{className:S().categoryBoxes,children:[(0,s.jsx)("div",{className:"".concat(S().categoryBox," ").concat("Sport"===N?S().selectedCategory:""),children:(0,s.jsx)("p",{children:"Sport"})}),(0,s.jsx)("div",{className:"".concat(S().categoryBox," ").concat("Arts and Culture"===N?S().selectedCategory:""),children:(0,s.jsx)("p",{children:"Arts and Culture"})}),(0,s.jsx)("div",{className:"".concat(S().categoryBox," ").concat("History"===N?S().selectedCategory:""),children:(0,s.jsx)("p",{children:"History"})}),(0,s.jsx)("div",{className:"".concat(S().categoryBox," ").concat("Science"===N?S().selectedCategory:""),children:(0,s.jsx)("p",{children:"Science"})}),(0,s.jsx)("div",{className:"".concat(S().categoryBox," ").concat("Random"===N?S().selectedCategory:""),children:(0,s.jsx)("p",{children:"Random"})})]})]}),(0,s.jsx)("div",{className:S().end,children:(0,s.jsx)("h2",{children:"Get ready to play!"})}),(0,s.jsx)(m(),{width:T,height:E,numberOfPieces:100,recycle:!1,run:o})]}),1===t&&(0,s.jsxs)("div",{className:S().waiting,children:[(0,s.jsx)("h1",{children:"Waiting for next question"}),(0,s.jsxs)("h2",{children:[ee," players left"]}),(0,s.jsxs)("h2",{className:S().funFact,children:[(0,s.jsx)("span",{className:"material-symbols-outlined",children:"info"}),L]})]}),2===t&&(0,s.jsxs)("div",{className:S().question,children:[(0,s.jsx)("h1",{children:I}),(0,s.jsx)("div",{className:S().answers,children:F.map((e,t)=>(0,s.jsxs)("div",{className:"\n                                ".concat(S().answer," ").concat(H===t?S().selectedAnswer:""," ").concat(U||t!==V?"":S().correctAnswer," ").concat(U||H!==t||R?"":S().wrongAnswer,"\n                                "),onClick:()=>{U&&-1===H&&!K&&p&&(Y(t),console.log("Submitting answer in game:",i.id),p.emit("answer",{gameId:i.id,userId:j.data,answer:t,questionNumber:P-1}))},children:[H===t&&(0,s.jsx)("span",{className:"material-symbols-outlined",children:"done"}),(0,s.jsx)("p",{children:e.text})]},t))}),(0,s.jsx)("div",{className:S().questionNumber,children:(0,s.jsxs)("p",{children:[P,"/10"]})}),U&&(0,s.jsx)("div",{className:S().timerCircle,style:{background:"conic-gradient(#FF70A600, #fff ".concat(W,"%, #FFD67000 ").concat(W,"%, #FFD67000)"),transition:"all 1s linear"},children:(0,s.jsx)("div",{className:S().timerContainer,children:(0,s.jsx)("h2",{children:J})})})]}),!U&&(0,s.jsx)(m(),{width:T,height:E,numberOfPieces:100,recycle:!1,run:R}),3===t&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:S().wonContainer,children:[(0,s.jsx)("h1",{children:"Congratulations!"}),(0,s.jsxs)("h2",{children:["You managed to answer all questions correctly and won the pot of ",c," Tokens!"]}),(0,s.jsx)("button",{onClick:()=>{console.log("Going back to dashboard"),goToDashboard()},children:"Leave game"}),(0,s.jsx)(Bubbles,{content:"\uD83E\uDD73"})]}),(0,s.jsx)(m(),{width:T,height:E,numberOfPieces:100,recycle:!0,run:!0})]}),4===t&&(0,s.jsxs)("div",{className:S().lostContainer,children:[(0,s.jsx)("h1",{children:"You lost."}),(0,s.jsx)("h2",{children:"Better luck next time!"}),(0,s.jsx)("button",{onClick:()=>{console.log("Going back to dashboard"),goToDashboard()},children:"Leave game"}),(0,s.jsx)(Bubbles,{content:"\uD83D\uDE2D"})]})]})}function Game(){let[e,t]=(0,a.useState)(0),[n,i]=(0,a.useState)(0),[o,l]=(0,a.useState)(null),[c,u]=(0,a.useState)(null),[d,m]=(0,a.useState)(null),p=(0,C.useRouter)();return(0,a.useEffect)(()=>{(0,b.C)(),function(){if(o)return;let e=(0,_.ZP)(N.h,{transports:["websocket"]});l(e),e.on("error",e=>{console.log(e),"busyBlockchain"===e?(0,h.H3)("Error","Blockchain is busy, please try again later."):"lobbyNotFound"!==e&&"alreadyInLobby"!==e&&"gameNotFound"!==e&&((0,h.H3)("Error","Couldn't connect to server."),p.push("/dashboard"))}),e.on("connect_error",e=>{console.log(e),(0,h.H3)("Error","Couldn't connect to server."),p.push("/dashboard")}),e.on("connect",()=>{console.log("Connected to server"),(0,b.n)()}),e.on("lobby",e=>{console.log("Joined lobby",e),u(e),i(1),setTimeout(()=>{t(1)},500)}),e.on("disconnect",()=>{console.log("Disconnected from server")}),e.on("startGame",e=>{console.log("Starting game"),console.log(e),m(e),i(2),setTimeout(()=>{t(2)},500)})}()},[]),(0,a.useEffect)(()=>()=>{o&&o.disconnect()},[o]),(0,s.jsxs)("main",{className:"".concat(r().main," ").concat(n!=e?r().disappear:""),children:[0===e&&(0,s.jsx)(Search,{websocket:o}),1===e&&(0,s.jsx)(Lobby,{websocket:o,lobby:c}),2===e&&(0,s.jsx)("div",{children:(0,s.jsx)(InGame,{websocket:o,lobby:c,game:d})}),3===e&&(0,s.jsx)("div",{children:(0,s.jsx)("h1",{children:"Results"})}),(0,s.jsx)(g.Z,{})]})}},21035:function(e,t,n){"use strict";n.d(t,{C:function(){return metamaskOneTimeLogin},H:function(){return fetchAddress}});var s=n(59498);let a=(0,s.U)("/metamask");async function metamaskOneTimeLogin(e,t,n,s){try{let i=await a.post("/auth",{signature:e,fingerprint:t,timestamp:n,username:s});return i}catch(e){return e}}async function fetchAddress(){try{let e=await a.get("/address");return e.data}catch(e){return e}}},36093:function(e,t,n){"use strict";n.d(t,{Gt:function(){return getLobbyUsers},Ml:function(){return changeCountry},Nk:function(){return updateProfilePicture},Uz:function(){return updateStyle},a$:function(){return registerUser},cO:function(){return getActiveUsers},gQ:function(){return updatePassword},n5:function(){return getUserId},pz:function(){return searchUsers}});var s=n(59498),a=n(21035);let i=(0,s.U)("/users");async function registerUser(e){try{let t=await i.post("/add",e);return t}catch(e){return e.response}}async function updateStyle(e){try{let t=await i.put("/style",{style:e});return t}catch(e){return e.response}}async function getUserId(){try{let e=await i.get("/userId");if(200!==e.status){let e=await (0,a.H)();return e}return e}catch(e){try{let e=await (0,a.H)();return e}catch(e){return e}}}async function updateProfilePicture(){try{let e=await i.put("/changeAvatar");return e}catch(e){return e.response}}async function updatePassword(e,t){try{let n=await i.put("/changePassword",{old:e,updated:t});return n}catch(e){return console.error("Error updating password:",e),e.response}}async function getLobbyUsers(e){try{let t=[];for(let n of e){let e=await i.get("/id/"+n);t.push(e.data)}if(0===t.length)throw console.error("Error fetching lobby users: no users found"),Error("No users found");if(t.length!==e.length)throw console.error("Error fetching lobby users: not all users found"),Error("Not all users found");return t}catch(e){return console.error("Error fetching lobby users:",e),e.response}}async function searchUsers(e){try{let t=await i.get("/getUsers/"+e);return t}catch(e){return e.response}}async function changeCountry(e){try{let t=await i.put("/changeCountry",{country:e});return t}catch(e){return e.response}}async function getActiveUsers(){try{let e=await i.get("/activeUsers");return e}catch(e){return e.response}}},69143:function(e,t,n){"use strict";n.d(t,{C:function(){return showLoadingScreen},n:function(){return hideLoadingScreen}}),n(67294),n(93040);let showLoadingScreen=()=>{let e=document.getElementById("loading-screen");e&&(e.style.display="flex")},hideLoadingScreen=()=>{let e=document.getElementById("loading-screen");e&&(e.style.display="none")}},52200:function(e,t,n){"use strict";n.d(t,{El:function(){return openNotificationInfo},H3:function(){return openNotificationError},kl:function(){return openNotificationSuccess}});var s=n(16318);let openNotificationError=(e,t)=>{s.ZP.error({message:e,description:t,duration:2})},openNotificationSuccess=(e,t)=>{s.ZP.success({message:e,description:t,duration:2})},openNotificationInfo=(e,t)=>{s.ZP.info({message:e,description:t,duration:2})}},18191:function(e,t,n){"use strict";n.d(t,{N1:function(){return getAverageQuestionOfUser},f1:function(){return getTransactions},lz:function(){return getTokens}});var s=n(52209),a=n(36093),i=n(74686);let r="https://eth-sepolia.g.alchemy.com/v2/IA22Anj6b1Wd0KS5Lji_wZf4MwP3IQPP",o="0x221772ff3DB4396820f9D9700F5aAE35DD3FA80f";async function getTokens(){try{let e=new s.ZPm(new s.ZPm.providers.HttpProvider(r)),t=new e.eth.Contract(i,o),n=await (0,a.n5)();console.log("UserId:",n),console.log(n.data);let l=await t.methods.getTokens(n.data).call();console.log("TokensRaw:",l);let c=Number(l);return console.log("Tokens:",c),c}catch(e){return console.log(e),-1}}async function getTransactions(){try{let e=new s.ZPm(new s.ZPm.providers.HttpProvider(r)),t=new e.eth.Contract(i,o),n=await (0,a.n5)(),l=await t.methods.getTransactions(n.data).call();return l}catch(e){return console.log(e),-1}}async function getAverageQuestionOfUser(){try{let e=new s.ZPm(new s.ZPm.providers.HttpProvider(r)),t=new e.eth.Contract(i,o),n=await (0,a.n5)(),l=await t.methods.getAverageQuestionOfUser(n.data).call();return l}catch(e){return console.log(e),-1}}},41064:function(e){e.exports={bubbleContainer:"bubbles_bubbleContainer__ZSoUS",bubble:"bubbles_bubble__htOi5"}},72537:function(e){e.exports={main:"game_main__6y2dI",disappear:"game_disappear__8aXZN"}},9057:function(e){e.exports={header:"header_header__rY90F",inner:"header_inner___XluN",logo:"header_logo__XtPtX",content:"header_content__v4Ap4",profile:"header_profile__f2DRM",dropdown:"header_dropdown__VYYBF",wallet:"header_wallet__SC9Rm"}},98466:function(e){e.exports={container:"inGame_container__h5ymh",intro:"inGame_intro__n31Nc",fadeOut:"inGame_fadeOut___7n2Y",fadeIn:"inGame_fadeIn__XVQ0L",categories:"inGame_categories__For8C",categoryBoxes:"inGame_categoryBoxes__Nr_ly",categoryBox:"inGame_categoryBox__rhZam",selectedCategory:"inGame_selectedCategory__TLn7A",selected:"inGame_selected__QhRFG",end:"inGame_end__ao8aH",question:"inGame_question__fykTg",glitch:"inGame_glitch__pdZCv",answers:"inGame_answers__tcvGT",answer:"inGame_answer__Rl4EE",selectedAnswer:"inGame_selectedAnswer__wTcWn",correctAnswer:"inGame_correctAnswer__v2aR_",wrongAnswer:"inGame_wrongAnswer__DTLHq",questionNumber:"inGame_questionNumber__nOFeb",timerCircle:"inGame_timerCircle__0IX_S",timerContainer:"inGame_timerContainer__73Ze0",waiting:"inGame_waiting__PsM6p",funFact:"inGame_funFact__Ce3b5",lostContainer:"inGame_lostContainer__mr83E",wonContainer:"inGame_wonContainer__Qc9wP"}},99205:function(e){e.exports={loaderContainer:"loadingScreen_loaderContainer__h4VEZ",loader:"loadingScreen_loader__fKF4R",spin:"loadingScreen_spin__iKqDv"}},56486:function(e){e.exports={lobby:"lobby_lobby__SjfaP",top:"lobby_top__sg8P4",dot:"lobby_dot__2EA_V",dotPulse:"lobby_dotPulse__8kZ3_",mid:"lobby_mid__GGd_g",user:"lobby_user__QJHvh",flag:"lobby_flag__FUx1D",activeEmote:"lobby_activeEmote__YMV_t",emoteAnim:"lobby_emoteAnim__xjDqv",sentEmote:"lobby_sentEmote__N9ohG",emoteAnimGiant:"lobby_emoteAnimGiant__rmkBZ",bottom:"lobby_bottom__ObWCS",emotes:"lobby_emotes__MHEb1",emote:"lobby_emote__fADoR",mute:"lobby_mute__9T0q9"}},14799:function(e){e.exports={main:"search_main__Ozgxq",content:"search_content__Bhkn1",searchFilter:"search_searchFilter___pcJj",expandButtonContainer:"search_expandButtonContainer__WNX1F",timeEstimateContainer:"search_timeEstimateContainer__fFuD_",buttonContainer:"search_buttonContainer__ch1pX",button:"search_button__Il90b",searchingContainer:"search_searchingContainer__1U1aq",searching:"search_searching__tGhn1",spinner:"search_spinner__Jvizf",spin:"search_spin___7mWr",searchingText:"search_searchingText__TDmdn",searchingButton:"search_searchingButton__RQxPi",bubbleContainer:"search_bubbleContainer__1ib09",bubble:"search_bubble__Wx0yq",searchOptionsContainer:"search_searchOptionsContainer__l_M_w",searchOption:"search_searchOption__n6lFM",miniGameContainer:"search_miniGameContainer__nlVQ0",searchingStatus:"search_searchingStatus__Rq8rj",miniGame:"search_miniGame__icPMK",grid:"search_grid__XVZDl",cell:"search_cell__WPBRG",cellRevealed:"search_cellRevealed__yfUl8",restartButtonContainer:"search_restartButtonContainer__wV8L_",restartButton:"search_restartButton___VTZW"}},46601:function(){},74686:function(e){"use strict";e.exports=JSON.parse('[{"inputs":[{"internalType":"uint256","name":"_minDeposit","type":"uint256"},{"internalType":"uint256","name":"_minDraw","type":"uint256"}],"stateMutability":"nonpayable","type":"constructor"},{"inputs":[{"internalType":"string","name":"user","type":"string"},{"internalType":"uint256","name":"balance","type":"uint256"}],"name":"addBalanceToUser","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"_gameId","type":"uint256"},{"internalType":"uint256","name":"_buyIn","type":"uint256"},{"internalType":"uint256","name":"_timeStamp","type":"uint256"},{"internalType":"uint16","name":"_players","type":"uint16"}],"name":"addGame","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"_gameId","type":"uint256"},{"internalType":"string","name":"userId","type":"string"}],"name":"addParticipantToGame","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"_gameId","type":"uint256"}],"name":"dealMoneyToWinners","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"string","name":"user","type":"string"}],"name":"deposit","outputs":[],"stateMutability":"payable","type":"function"},{"inputs":[],"name":"getAllTokens","outputs":[{"internalType":"uint256[]","name":"","type":"uint256[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"_gameId","type":"uint256"}],"name":"getAverageQuestionOfGame","outputs":[{"internalType":"uint8","name":"","type":"uint8"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"string","name":"userId","type":"string"}],"name":"getAverageQuestionOfUser","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"_gameId","type":"uint256"}],"name":"getGame","outputs":[{"internalType":"contract GameContract","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getMinDeposit","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getMinDraw","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getOwner","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getScoreTable","outputs":[{"components":[{"internalType":"string","name":"userName","type":"string"},{"internalType":"uint256","name":"score","type":"uint256"}],"internalType":"struct Storage.UserScore[]","name":"","type":"tuple[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"string","name":"user","type":"string"}],"name":"getTokens","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"string","name":"userId","type":"string"}],"name":"getTransactions","outputs":[{"components":[{"internalType":"string","name":"transactionType","type":"string"},{"internalType":"uint256","name":"amount","type":"uint256"},{"internalType":"uint256","name":"timeStamp","type":"uint256"}],"internalType":"struct TransactionStruct.Transaction[]","name":"","type":"tuple[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"string","name":"_userId","type":"string"}],"name":"getUserGames","outputs":[{"internalType":"uint256[]","name":"","type":"uint256[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"_gameId","type":"uint256"},{"internalType":"string","name":"userId","type":"string"}],"name":"isUserInGame","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"_gameId","type":"uint256"},{"internalType":"string","name":"userId","type":"string"}],"name":"kickParticipant","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"string","name":"user","type":"string"}],"name":"register","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"_gameId","type":"uint256"}],"name":"updateQuestionCounter","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"string","name":"user","type":"string"},{"internalType":"uint256","name":"drawAmount","type":"uint256"}],"name":"withdraw","outputs":[],"stateMutability":"payable","type":"function"}]')}},function(e){e.O(0,[664,209,675,318,853,920,69,774,888,179],function(){return e(e.s=23874)}),_N_E=e.O()}]);