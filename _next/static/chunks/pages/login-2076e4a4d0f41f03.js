(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[459],{36429:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/login",function(){return n(21017)}])},43843:function(e,t,n){"use strict";n.d(t,{Z:function(){return ArrowLink}});var r=n(85893),a=n(16081),i=n.n(a),s=n(41664),o=n.n(s);function ArrowLink(e){let{href:t}=e;return(0,r.jsx)("div",{className:i().arrowLink,children:(0,r.jsx)(o(),{href:t,children:(0,r.jsx)("div",{className:i().arrowicon,children:(0,r.jsx)("span",{className:"material-symbols-outlined",children:"arrow_back_ios_new"})})})})}},93870:function(e,t,n){"use strict";var r=n(85893),a=n(67294),i=n(15385),s=n.n(i);t.Z=function(e){let{title:t}=e,[n,i]=(0,a.useState)(Array.from(t).map(()=>!1));function handleKeyDown(e){let r=t.toLowerCase().indexOf(e.key);if(-1!==r){let e=[...n];e[r]=!0,i(e)}}function handleKeyUp(e){let r=t.toLowerCase().indexOf(e.key);if(-1!==r){let e=[...n];e[r]=!1,i(e)}}return(0,a.useEffect)(()=>(window.addEventListener("keydown",handleKeyDown),window.addEventListener("keyup",handleKeyUp),()=>{window.removeEventListener("keydown",handleKeyDown),window.removeEventListener("keyup",handleKeyUp)}),[n]),(0,r.jsx)("div",{className:s().title,children:Array.from(t).map((e,t)=>(0,r.jsx)("h1",{style:{marginTop:n[t]?"0.5rem":"0"},className:s().letter,children:e},t))})}},61136:function(e,t,n){"use strict";n.d(t,{Z:function(){return Cookie}});var r=n(85893),a=n(80308),i=n.n(a),s=n(41664),o=n.n(s);function Cookie(){return(0,r.jsx)("div",{className:i().cookie,children:(0,r.jsx)(o(),{href:"/cookies",children:(0,r.jsx)("div",{className:i().cookieicon,children:(0,r.jsx)("span",{className:"material-symbols-outlined",children:"cookie"})})})})}},21017:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return Login}});var r=n(85893),a=n(61747),i=n.n(a),s=n(41664),o=n.n(s),u=n(61136),l=n(93870),c=n(43843),p=n(67294),y=n(15182),d=n(95771),m=n(11163),f=n(18191),g=n(52200);function Login(){let[e,t]=(0,p.useState)(""),[n,a]=(0,p.useState)(""),[s,w]=(0,p.useState)(""),[h,_]=(0,p.useState)(""),[v,T]=(0,p.useState)(""),[b,k]=(0,p.useState)(!1),N=(0,p.useRef)(null),x=(0,m.useRouter)(),[P,I]=(0,p.useState)(null),[S,U]=(0,p.useState)(null);async function onSubmit(t){if(t.preventDefault(),console.log(P),e.length<1?(_("Please enter a username or email"),(0,g.H3)("No username","Please enter a username or email"),1):n.length<1?(_("Please enter a password"),(0,g.H3)("No password","Please enter a password"),1):(_(""),0))console.log("Invalid");else{console.log(e,n,s);let t=await (0,d.pH)({name:e,password:n,fingerprint:s,code:v});if(console.log(t),404===t.status||401===t.status){_("Username or password is incorrect"),(0,g.H3)("Invalid credentials","Username or password is incorrect");return}if(500===t.status){_("Server error"),(0,g.H3)("Server error","Please try again later");return}if(400===t.status){if("No code provided"===t.data){(0,g.El)("2FA","Please enter your 2FA code"),T(""),k(!0);return}if("Invalid code provided"===t.data){(0,g.H3)("Invalid code","Please enter a valid 2FA code"),T("");return}(0,g.H3)("Invalid request","Please try again later");return}if(console.log("Logged in"),t&&t.data&&t.data.user){let e=await (0,f.lz)();t.data.user.tokens=e,I(t.data.user),U(t.data.user),console.log("User set")}x.push("/dashboard");let r=localStorage.getItem("user");r&&console.log("Stored user:",JSON.parse(r))}}return(0,p.useEffect)(()=>{let e=localStorage.getItem("user");e&&(U(JSON.parse(e)),console.log("Initial stored user:",JSON.parse(e)))},[]),(0,p.useEffect)(()=>{S&&localStorage.setItem("user",JSON.stringify(S))},[S]),(0,p.useEffect)(()=>{N.current.style.opacity=1,async function(){let e=await y.ZP.load(),t=await e.get();w(t.visitorId)}()},[]),(0,r.jsxs)("main",{className:i().main,ref:N,children:[(0,r.jsx)(l.Z,{title:"Login"}),(0,r.jsx)(c.Z,{href:"/"}),(0,r.jsx)("div",{className:i().content,children:(0,r.jsxs)("form",{onSubmit:onSubmit,children:[!b&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("input",{type:"text",placeholder:"Username/Email",value:e,onChange:e=>t(e.target.value)}),(0,r.jsx)("input",{type:"password",placeholder:"Password",value:n,onChange:e=>a(e.target.value)})]}),b&&(0,r.jsx)(r.Fragment,{children:(0,r.jsx)("input",{type:"text",placeholder:"2FA Code",value:v,onChange:e=>T(e.target.value)})}),(0,r.jsx)("button",{type:"submit",children:"Login"}),(0,r.jsxs)("div",{className:i().links,children:[(0,r.jsx)(o(),{href:"/register",children:"Register"}),(0,r.jsx)(o(),{href:"/forgot",children:"Forgot Password"})]}),(0,r.jsx)("p",{className:i().error,children:h})]})}),(0,r.jsx)(u.Z,{})]})}n(61677)},21035:function(e,t,n){"use strict";n.d(t,{C:function(){return metamaskOneTimeLogin},H:function(){return fetchAddress}});var r=n(59498);let a=(0,r.U)("/metamask");async function metamaskOneTimeLogin(e,t,n,r){try{let i=await a.post("/auth",{signature:e,fingerprint:t,timestamp:n,username:r});return i}catch(e){return e}}async function fetchAddress(){try{let e=await a.get("/address");return e.data}catch(e){return e}}},36093:function(e,t,n){"use strict";n.d(t,{Gt:function(){return getLobbyUsers},Ml:function(){return changeCountry},Nk:function(){return updateProfilePicture},Uz:function(){return updateStyle},a$:function(){return registerUser},cO:function(){return getActiveUsers},gQ:function(){return updatePassword},n5:function(){return getUserId},pz:function(){return searchUsers}});var r=n(59498),a=n(21035);let i=(0,r.U)("/users");async function registerUser(e){try{let t=await i.post("/add",e);return t}catch(e){return e.response}}async function updateStyle(e){try{let t=await i.put("/style",{style:e});return t}catch(e){return e.response}}async function getUserId(){try{let e=await i.get("/userId");if(200!==e.status){let e=await (0,a.H)();return e}return e}catch(e){try{let e=await (0,a.H)();return e}catch(e){return e}}}async function updateProfilePicture(){try{let e=await i.put("/changeAvatar");return e}catch(e){return e.response}}async function updatePassword(e,t){try{let n=await i.put("/changePassword",{old:e,updated:t});return n}catch(e){return console.error("Error updating password:",e),e.response}}async function getLobbyUsers(e){try{let t=[];for(let n of e){let e=await i.get("/id/"+n);t.push(e.data)}if(0===t.length)throw console.error("Error fetching lobby users: no users found"),Error("No users found");if(t.length!==e.length)throw console.error("Error fetching lobby users: not all users found"),Error("Not all users found");return t}catch(e){return console.error("Error fetching lobby users:",e),e.response}}async function searchUsers(e){try{let t=await i.get("/getUsers/"+e);return t}catch(e){return e.response}}async function changeCountry(e){try{let t=await i.put("/changeCountry",{country:e});return t}catch(e){return e.response}}async function getActiveUsers(){try{let e=await i.get("/activeUsers");return e}catch(e){return e.response}}},52200:function(e,t,n){"use strict";n.d(t,{El:function(){return openNotificationInfo},H3:function(){return openNotificationError},kl:function(){return openNotificationSuccess}});var r=n(16318);let openNotificationError=(e,t)=>{r.ZP.error({message:e,description:t,duration:2})},openNotificationSuccess=(e,t)=>{r.ZP.success({message:e,description:t,duration:2})},openNotificationInfo=(e,t)=>{r.ZP.info({message:e,description:t,duration:2})}},18191:function(e,t,n){"use strict";n.d(t,{N1:function(){return getAverageQuestionOfUser},f1:function(){return getTransactions},lz:function(){return getTokens}});var r=n(52209),a=n(36093),i=n(74686);let s="https://eth-sepolia.g.alchemy.com/v2/IA22Anj6b1Wd0KS5Lji_wZf4MwP3IQPP",o="0x221772ff3DB4396820f9D9700F5aAE35DD3FA80f";async function getTokens(){try{let e=new r.ZPm(new r.ZPm.providers.HttpProvider(s)),t=new e.eth.Contract(i,o),n=await (0,a.n5)();console.log("UserId:",n),console.log(n.data);let u=await t.methods.getTokens(n.data).call();console.log("TokensRaw:",u);let l=Number(u);return console.log("Tokens:",l),l}catch(e){return console.log(e),-1}}async function getTransactions(){try{let e=new r.ZPm(new r.ZPm.providers.HttpProvider(s)),t=new e.eth.Contract(i,o),n=await (0,a.n5)(),u=await t.methods.getTransactions(n.data).call();return u}catch(e){return console.log(e),-1}}async function getAverageQuestionOfUser(){try{let e=new r.ZPm(new r.ZPm.providers.HttpProvider(s)),t=new e.eth.Contract(i,o),n=await (0,a.n5)(),u=await t.methods.getAverageQuestionOfUser(n.data).call();return u}catch(e){return console.log(e),-1}}},16081:function(e){e.exports={arrowLink:"arrowLink_arrowLink__fgs27",arrowicon:"arrowLink_arrowicon__5l8LL"}},15385:function(e){e.exports={title:"bouncyTitle_title__2KeEK"}},80308:function(e){e.exports={cookie:"cookie_cookie__mXhcj",cookieicon:"cookie_cookieicon__Nl2Jo",main:"cookie_main__ziqG1",title:"cookie_title__oz4bW",content:"cookie_content__F4wcF"}},61747:function(e){e.exports={main:"login_main__ucu6W",content:"login_content__AWx6l",select:"login_select__Oi9Og",select__control:"login_select__control__D7BzQ",links:"login_links__Q7Vh5",error:"login_error__7qKfL"}},46601:function(){},74686:function(e){"use strict";e.exports=JSON.parse('[{"inputs":[{"internalType":"uint256","name":"_minDeposit","type":"uint256"},{"internalType":"uint256","name":"_minDraw","type":"uint256"}],"stateMutability":"nonpayable","type":"constructor"},{"inputs":[{"internalType":"string","name":"user","type":"string"},{"internalType":"uint256","name":"balance","type":"uint256"}],"name":"addBalanceToUser","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"_gameId","type":"uint256"},{"internalType":"uint256","name":"_buyIn","type":"uint256"},{"internalType":"uint256","name":"_timeStamp","type":"uint256"},{"internalType":"uint16","name":"_players","type":"uint16"}],"name":"addGame","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"_gameId","type":"uint256"},{"internalType":"string","name":"userId","type":"string"}],"name":"addParticipantToGame","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"_gameId","type":"uint256"}],"name":"dealMoneyToWinners","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"string","name":"user","type":"string"}],"name":"deposit","outputs":[],"stateMutability":"payable","type":"function"},{"inputs":[],"name":"getAllTokens","outputs":[{"internalType":"uint256[]","name":"","type":"uint256[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"_gameId","type":"uint256"}],"name":"getAverageQuestionOfGame","outputs":[{"internalType":"uint8","name":"","type":"uint8"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"string","name":"userId","type":"string"}],"name":"getAverageQuestionOfUser","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"_gameId","type":"uint256"}],"name":"getGame","outputs":[{"internalType":"contract GameContract","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getMinDeposit","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getMinDraw","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getOwner","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getScoreTable","outputs":[{"components":[{"internalType":"string","name":"userName","type":"string"},{"internalType":"uint256","name":"score","type":"uint256"}],"internalType":"struct Storage.UserScore[]","name":"","type":"tuple[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"string","name":"user","type":"string"}],"name":"getTokens","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"string","name":"userId","type":"string"}],"name":"getTransactions","outputs":[{"components":[{"internalType":"string","name":"transactionType","type":"string"},{"internalType":"uint256","name":"amount","type":"uint256"},{"internalType":"uint256","name":"timeStamp","type":"uint256"}],"internalType":"struct TransactionStruct.Transaction[]","name":"","type":"tuple[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"string","name":"_userId","type":"string"}],"name":"getUserGames","outputs":[{"internalType":"uint256[]","name":"","type":"uint256[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"_gameId","type":"uint256"},{"internalType":"string","name":"userId","type":"string"}],"name":"isUserInGame","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"_gameId","type":"uint256"},{"internalType":"string","name":"userId","type":"string"}],"name":"kickParticipant","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"string","name":"user","type":"string"}],"name":"register","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"_gameId","type":"uint256"}],"name":"updateQuestionCounter","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"string","name":"user","type":"string"},{"internalType":"uint256","name":"drawAmount","type":"uint256"}],"name":"withdraw","outputs":[],"stateMutability":"payable","type":"function"}]')}},function(e){e.O(0,[664,209,318,774,888,179],function(){return e(e.s=36429)}),_N_E=e.O()}]);