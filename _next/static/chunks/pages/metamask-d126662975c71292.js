(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[525],{14655:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/metamask",function(){return t(36554)}])},43843:function(e,n,t){"use strict";t.d(n,{Z:function(){return ArrowLink}});var o=t(85893),a=t(16081),i=t.n(a),r=t(41664),s=t.n(r);function ArrowLink(e){let{href:n}=e;return(0,o.jsx)("div",{className:i().arrowLink,children:(0,o.jsx)(s(),{href:n,children:(0,o.jsx)("div",{className:i().arrowicon,children:(0,o.jsx)("span",{className:"material-symbols-outlined",children:"arrow_back_ios_new"})})})})}},61136:function(e,n,t){"use strict";t.d(n,{Z:function(){return Cookie}});var o=t(85893),a=t(80308),i=t.n(a),r=t(41664),s=t.n(r);function Cookie(){return(0,o.jsx)("div",{className:i().cookie,children:(0,o.jsx)(s(),{href:"/cookies",children:(0,o.jsx)("div",{className:i().cookieicon,children:(0,o.jsx)("span",{className:"material-symbols-outlined",children:"cookie"})})})})}},36554:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return Metamask}});var o=t(85893),a=t(47808),i=t.n(a),r=t(25675),s=t.n(r),c=t(61136),l=t(43843),u=t(67294),d=t(52200),f=t(15182),m=t(52209),h=t(21035),_=t(11163),k=JSON.parse('{"r":["Emily","John","Mia","Aiden","Sophia","Liam","Olivia","Noah","Ava","Ethan","Sam","Mike","Chris","Felix","Barack","Donald","Ash"],"a":["Smith","Johnson","Williams","Brown","Jones","Garcia","Miller","Davis","Rodri","Martin","Litoris","O\'Nella","Cox","Kjellberg","Obama","Trump","Ketchum"]}');function Metamask(){let e=(0,u.useRef)(null),[n,t]=(0,u.useState)(1),[a,r]=(0,u.useState)(""),[w,g]=(0,u.useState)(null),[p,M]=(0,u.useState)(!1),N=0,x=(0,_.useRouter)();async function getFingerprint(){let e=await f.ZP.load(),n=await e.get();return n.visitorId}async function signMessageMetaMask(){if(w&&a)try{if(p){console.log("Already asked for signature");return}if(M(!0),++N>1){console.log("Aborted action since no signature was provided. Please reconnect with MetaMask");return}console.log("Counter: ",N);let e=function(){let e=k.r,n=k.a,t=e[Math.floor(Math.random()*e.length)],o=n[Math.floor(Math.random()*n.length)];return"".concat(t," ").concat(o," @").concat(Math.floor(1e3+9e3*Math.random()))}(),n=await getFingerprint(),t=Date.now(),o="'Please sign this as a unique message: ".concat(n).concat(t,"'"),i=await w.eth.personal.sign(o,a,""),r=await (0,h.C)(i,n,t,e);delete r.data._id;let s=JSON.stringify(r.data);localStorage.setItem("user",s),x.push("/dashboard")}catch(e){(0,d.H3)("Aborted action","Aborted action since no signature was provided. Please reconnect with MetaMask"),t(2)}else(0,d.H3)("No web3 instance or address found"),t(2)}let connectWallet=async()=>{if(window&&window.ethereum){g(new m.ZPm(window.ethereum));let e=await window.ethereum.request({method:"eth_requestAccounts"});console.log("Address: ",e[0]),r(e[0])}};return(0,u.useEffect)(()=>{if(!a)try{connectWallet()}catch(e){t(1),console.log("Could not connect to metamask: ",e),(0,d.H3)("Could not sign the connected wallet message due to: ",e)}e.current.style.opacity=1},[]),(0,u.useEffect)(()=>{a&&w&&!p&&setTimeout(()=>{console.log("Going to sign message"),signMessageMetaMask()},2e3)},[a]),(0,o.jsxs)("main",{className:i().main,ref:e,children:[(0,o.jsxs)("div",{className:i().loader,children:[(0,o.jsx)("div",{className:i().loaderCircle,style:{display:1==n?"flex":"none"}}),(0,o.jsx)(s(),{src:"/img/MetaMask_fox.svg",width:128,height:128,alt:"MetaMask Fox Loading Icon"})]}),(0,o.jsx)(l.Z,{href:"/"}),(0,o.jsx)(c.Z,{})]})}},21035:function(e,n,t){"use strict";t.d(n,{C:function(){return metamaskOneTimeLogin},H:function(){return fetchAddress}});var o=t(59498);let a=(0,o.U)("/metamask");async function metamaskOneTimeLogin(e,n,t,o){try{let i=await a.post("/auth",{signature:e,fingerprint:n,timestamp:t,username:o});return i}catch(e){return e}}async function fetchAddress(){try{let e=await a.get("/address");return e.data}catch(e){return e}}},52200:function(e,n,t){"use strict";t.d(n,{El:function(){return openNotificationInfo},H3:function(){return openNotificationError},kl:function(){return openNotificationSuccess}});var o=t(16318);let openNotificationError=(e,n)=>{o.ZP.error({message:e,description:n,duration:2})},openNotificationSuccess=(e,n)=>{o.ZP.success({message:e,description:n,duration:2})},openNotificationInfo=(e,n)=>{o.ZP.info({message:e,description:n,duration:2})}},16081:function(e){e.exports={arrowLink:"arrowLink_arrowLink__fgs27",arrowicon:"arrowLink_arrowicon__5l8LL"}},80308:function(e){e.exports={cookie:"cookie_cookie__mXhcj",cookieicon:"cookie_cookieicon__Nl2Jo",main:"cookie_main__ziqG1",title:"cookie_title__oz4bW",content:"cookie_content__F4wcF"}},47808:function(e){e.exports={main:"metamask_main__Dld3q",loader:"metamask_loader__4nd0h",loaderCircle:"metamask_loaderCircle__jd3xa",spin:"metamask_spin__APSeS"}},46601:function(){}},function(e){e.O(0,[664,209,675,318,774,888,179],function(){return e(e.s=14655)}),_N_E=e.O()}]);