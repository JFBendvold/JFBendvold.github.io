import{U as w,Y as _,r as d,m as b,Z as E,H as D,t as k,o as m,c as g,b as s,d as P,v as j,F,L as x,p as f}from"./index-2e410ad1.js";const v=w("product");async function Z(e){try{return await v.get("/ean/"+e)}catch(r){throw r}}async function H(e){try{return await v.post("/",e)}catch(r){throw r}}async function C(e){try{return await v.get("/name/"+e)}catch(r){throw r}}function T(){return"7Y0pACrnoqzFuKO1njUvqIjZF0G6ysfzCCrMuxjA"}const y=_.create({baseURL:"https://kassal.app/api/v1/products",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+T()}});async function I(e){try{return await y.get("?search="+e+"&sort=name_asc")}catch(r){throw new Error("Et problem oppsto ved henting av produkter: "+r)}}async function A(e){try{return await y.get("/ean/"+e)}catch{throw new Error("Et problem oppsto ved henting av produktet: "+e)}}const h=w("fridges");async function O(e){try{return await h.post("/group/product",e)}catch{throw new Error("Kunne ikke legge til produktet til kjøleskapet.")}}async function J(e){try{return await h.get("/group/"+e)}catch{throw new Error("Kunne ikke finne kjøleskapet til gruppen med ID: "+e)}}async function Q(e,r){try{return await h.delete("/group/delete/product/"+e+"/"+r.toFixed(2))}catch{throw new Error("Kunne ikke fjerne produktet med ID: "+e+" fra kjøleskapet.")}}async function X(e){try{return await h.delete("/waste/product/"+e)}catch{throw new Error("Kunne ikke fjerne produktet med ID: "+e+" fra kjøleskapet.")}}function B(e){let r=[];for(let t=0;t<e.length;t++)e[t].ean!=null&&r.push({name:e[t].name,image:e[t].image,ean:e[t].ean});return r}function ee(e){let r=[];for(let t=0;t<e.products.length;t++){let o=e.products[t].amount;o==null&&(o=1);let n=e.products[t].ean.unit;n==null&&(n="stk");let c=new Date(e.products[t].purchaseDate),u=c;u.setDate(c.getDate()+e.products[t].daysToExpiration);let i=Math.ceil((u-new Date)/(1e3*60*60*24));r.push({productId:e.products[t].id,name:e.products[t].ean.name,image:e.products[t].ean.url,ean:e.products[t].ean.ean,daysToExpiration:e.products[t].daysToExpiration,remainingDays:i,purchaseDate:e.products[t].purchaseDate,amount:o,unit:n.toLowerCase(),allergies:e.products[t].ean.allergies})}return r}function te(e){let r=[];for(let t=0;t<e.products.length;t++){let o=e.products[t].price;o==null&&(o="?"),r.push({productId:t,name:e.products[t].name,image:e.products[t].url,ean:e.products[t].ean,amount:e.products[t].amount,price:o})}return r}const N=["agurk","aubergine","avokado","blomkål","brokkoli","brusselkål","bønner","gulrot","hvitløk","kål","løk","mais","paprika","potet","rødbeter","salat","spinat","squash","tomat","selleri","sopp","asparges","erter","fennikel","grønnkål","hokkaido gresskar","hvit asparges","purre","jordskokk","kikerter","knutekål","neper","rødkål","vårløk","ananas","appelsin","aprikos","banan","blåbær","bringebær","druer","eple","røde epler","grønne epler","gule epler","fersken","jordbær","kiwi","lime","mango","melon","moreller","pære","plomme","sitron","stikkelsbær","vannmelon","granateple","kirsebær","rips","solbær"],L={products:N},K={class:"product-search"},S={class:"product-search-input"},M={class:"product-search-results"},U={class:"product-search-result-image"},q=["src"],z={class:"product-search-result-info"},V={class:"product-search-result-name"},$={class:"product-search-result-ean"},G={class:"product-search-result-button"},R=["onClick"],re={__name:"ProductSearch",emits:["foundProduct"],setup(e,{emit:r}){function t(i){r("foundProduct",i)}const o=d([]),n=d(""),c=d([]),u=d(0),p=d(null);return b(async()=>{o.value=L.products,o.value=E(o.value)}),D(n,async()=>{p.value&&clearTimeout(p.value),u.value++;const i=u.value;p.value=setTimeout(async()=>{if(n.value=n.value.toLowerCase(),o.value.includes(n.value))try{const a=await C(n.value);c.value=[{name:a.data.name,image:a.data.url,ean:a.data.ean}]}catch(a){k(a)}else if(!isNaN(n.value)&&n.value.length>7)try{const a=await A(n.value);if(i===u.value&&(c.value=[{name:a.data.data.products[0].name,image:a.data.data.products[0].image,ean:a.data.data.ean}],c.value.length===0))throw new Error("Fant ingen produkter med gitt EAN")}catch(a){k(a)}else try{const a=await I(n.value);if(i===u.value&&(c.value=B(a.data.data)),c.value.length===0)throw new Error("Fant ingen produkter med gitt søkeord")}catch(a){k(a)}},600)}),(i,a)=>(m(),g("div",K,[s("div",S,[P(s("input",{type:"text","onUpdate:modelValue":a[0]||(a[0]=l=>n.value=l),placeholder:"Søk på navn eller EAN"},null,512),[[j,n.value]])]),s("div",M,[(m(!0),g(F,null,x(c.value,l=>(m(),g("div",{class:"product-search-result",key:l.ean},[s("div",U,[s("img",{src:l.image},null,8,q)]),s("div",z,[s("div",V,f(l.name),1),s("div",$,f(l.ean),1)]),s("div",G,[s("button",{onClick:W=>t(l.ean)},"Velg",8,R)])]))),128))])]))}};export{re as _,H as a,O as b,J as c,ee as d,A as e,Z as f,X as g,te as h,Q as r};
