import{r as u,a as R,m as V,s as d,u as h,a2 as M,j as v,o as s,c as a,e as I,f as $,b as o,x as c,q as F,F as D,L as b,p as g,g as T,t as l,a3 as K,h as P,y as _,z,A as j,B as q,d as O,a4 as H,a5 as J,a6 as Q}from"./index-689421b9.js";import{_ as W}from"./SetupGroup-3af40ea2.js";const X={class:"group-settings-container"},Y=o("div",{class:"group-settings-title"},[o("h1",null,"Grupper")],-1),Z={class:"group-settings-actions"},ee={key:0,class:"group-settings-selector"},oe=["onClick"],te={class:"group-button-name"},se={key:1,class:"group-overview"},ne={class:"group-overview-title"},ae={class:"group-overview-code"},re=o("h2",null,"Gruppekode:",-1),ue={class:"group-overview-members"},le={key:0,class:"member-role-edit"},ie=["onUpdate:modelValue","onChange"],ce=o("option",{value:"ADMIN"},"Administrator",-1),pe=o("option",{value:"MEMBER"},"Medlem",-1),de=o("option",{value:"RESTRICTED"},"Begrenset",-1),he=[ce,pe,de],ve={key:1,class:"member-role"},ge={key:0},_e={key:1},me={key:2},fe={class:"leave-group-button"},ke={__name:"GroupSettings",setup(N){const m=T(),f=u([]),r=u(null),C=u(""),w=R().getGroupID,i=u(!1),A=u([]),k=u(""),G=u(!1);V(async()=>{d(),h().getUsername;const e=await M();console.log(e);for(let t=0;t<e.length;t++)f.value.push(e[t]);v()});function S(e){C.value=e.groupName,console.log(e.groupId),r.value=e.groupId,B()}async function B(){d();const e=await J(r.value);console.log(e.data),k.value=e.data.linkCode;for(let t=0;t<e.data.userAuthorityInfoList.length;t++)e.data.userAuthorityInfoList[t].authority==="ADMIN"&&e.data.userAuthorityInfoList[t].username===h().getUsername&&(G.value=!0,console.log("Admin")),A.value.push(e.data.userAuthorityInfoList[t]);v()}function E(){const e=document.createElement("textarea");e.value=k.value,document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e),l("Gruppekode kopiert til utklippstavle")}async function L(e){d();try{await Q(r.value,e.username,e.authority),l("Brukerens rolle er oppdatert")}catch(t){l("Kunne ikke oppdatere brukerens rolle"),console.log(t)}console.log(e.authority),v()}function U(){m.push("/")}async function x(e){const t=h();if(!e){l("Gruppe-ID mangler");return}console.log("Main group: "+w),d();try{console.log(r.value),confirm("Er du sikker pÃ¥ at du vil forlate gruppen?")&&((await K(r.value,t.getUsername)).status===200?(l("Du har forlatt gruppen"),await M(),m.push("/profile")):l("Kunne ikke forlate gruppen"))}catch(p){console.log(p),l("Kunne ikke forlate gruppen")}v()}return(e,t)=>{const p=P("router-link");return s(),a("div",X,[I(p,{to:"/profile",class:"back-button"},{default:$(()=>[I(_(z),{icon:_(j)},null,8,["icon"])]),_:1}),Y,o("div",Z,[r.value===null&&!i.value?(s(),a("button",{key:0,class:"group-settings-button",onClick:t[0]||(t[0]=n=>i.value=!i.value)}," Opprett/bli med i en gruppe ")):c("",!0),i.value?(s(),F(W,{key:1,onNextStep:U})):c("",!0)]),r.value===null&&!i.value?(s(),a("div",ee,[(s(!0),a(D,null,b(f.value,n=>(s(),a("div",{class:q(["group-button",{active:n.group.groupId===_(w)}]),key:n.group.groupId,onClick:y=>S(n.group)},[o("div",te,[o("h2",null,g(n.group.groupName),1)])],10,oe))),128))])):c("",!0),r.value!==null&&!i.value?(s(),a("div",se,[o("div",ne,[o("h1",null,g(C.value),1)]),o("div",ae,[re,o("h2",{class:"group-code",onClick:E},g(k.value),1)]),o("div",ue,[(s(!0),a(D,null,b(A.value,n=>(s(),a("div",{class:"member",key:n.username},[o("h2",null,g(n.username),1),G.value&&n.username!==_(h)().getUsername&&n.authority!=="ADMIN"?(s(),a("div",le,[O(o("select",{"onUpdate:modelValue":y=>n.authority=y,onChange:y=>L(n)},he,40,ie),[[H,n.authority]])])):(s(),a("div",ve,[n.authority==="ADMIN"?(s(),a("h3",ge,"Administrator")):n.authority==="RESTRICTED"?(s(),a("h3",_e,"Begrenset")):(s(),a("h3",me,"Medlem"))]))]))),128))])])):c("",!0),o("div",fe,[r.value!==null?(s(),a("button",{key:0,class:"leave-group",onClick:x},"Forlat gruppe")):c("",!0)])])}}},Ce={__name:"GroupView",setup(N){return(m,f)=>(s(),a("main",null,[I(ke)]))}};export{Ce as default};
